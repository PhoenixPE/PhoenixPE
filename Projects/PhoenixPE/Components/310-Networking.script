[License]
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// This script is part of the PhoenixPE project and distributed under the MIT License.
//
// Additional 3rd party tools, encoded files, and programs used by the project are the property
// of their respective authors and may be subject to their own license agreement.
//
// Copyright (c) 2014-2025 Jonathan Holmgren (Homes32)
// Portions based on work by ChrisR, KYHI, and Holger
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////

[Main]
Title=Networking
Description=Core Network Support
Author=Homes32
Level=4
Selected=True
Mandatory=False
Version=1.8.0.0
Date=2025-04-27

[Variables]
%SID-Netprofm%="S-1-5-80-3635958274-2059881490-2225992882-984577281-633327304"
%SID-NlaSvc%="S-1-5-80-3141615172-2057878085-1754447212-2405740020-3916490453"
%SID-WwanSvc%="S-1-5-80-3981856537-581775623-1136376035-2066872258-409572886"
%SID-UnknownAccount1%="S-1-5-32-556"
%SID-UnknownAccount2%="S-1-5-92-1467204242-1103346305-4253404563-2848856930-0"

[Process]
Echo,"Configuring Network Support..."
RunFromRam

Echo,"Loading registry hives..."
RegLoadHives

// Extract Files
Run,%ScriptFile%,ExtractFiles

// Network Registry Config
Run,%ScriptFile%,Config-Network

// AutoRuns
If,%cb_EnableNetworkListService%,Equal,True,Begin
  // Net Start: SystemSetupInProgress=0 -> Net Start netprofm -> SystemSetupInProgress=1
  // netprofm needs wfplwfs.sys for pnidui icon
  AddStartupConfig,Network,"SetSplashText(#$qStarting Network List Service...#$q)#$xRegWrite(#$qHKLM\SYSTEM\Setup#$q, #$qSystemSetupInProgress#$q, #$qREG_DWORD#$q, 0)#$xRunProgramWait(@SystemDir & #$q\Net.exe#$q, #$qStart netprofm#$q, @ScriptDir, @SW_HIDE)#$xRegWrite(#$qHKLM\SYSTEM\Setup#$q, #$qSystemSetupInProgress#$q, #$qREG_DWORD#$q, 1)"
End

// Shortcuts
If,%cb_DesktopShc_InitNetwork%,Equal,True,AddShortcut,Desktop,"",%txt_ShortcutName_InitNetwork%,"cmd.exe","/C @Echo InitializeNetwork... & wpeutil.exe InitializeNetwork & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",170,"","","Initialize Network Settings"
If,%cb_StartMenuShc_InitNetwork%,Equal,True,AddShortcut,StartMenu,%txt_StartMenuFolder_InitNetwork%,%txt_ShortcutName_InitNetwork%,"cmd.exe","/C @Echo InitializeNetwork... & wpeutil.exe InitializeNetwork & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",170,"","","Initialize Network Settings"

If,%cb_DesktopShc_Firewall%,Equal,True,Begin
  AddShortcut,Desktop,"",%txt_ShortcutName_FirewallEnable%,"cmd.exe","/C @Echo Enable Firewall... & wpeutil.exe EnableFirewall & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",101,"","","Enable the Windows Firewall"
  AddShortcut,Desktop,"",%txt_ShortcutName_FirewallDisable%,"cmd.exe","/C @Echo Disable Firewall... & wpeutil.exe DisableFirewall & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",100,"","","Disable the Windows Firewall"
End

If,%cb_StartMenuShc_Firewall%,Equal,True,Begin
  AddShortcut,StartMenu,%txt_StartMenuFolder_Firewall%,%txt_ShortcutName_FirewallEnable%,"cmd.exe","/C @Echo Enable Firewall... & wpeutil.exe EnableFirewall & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",101,"","","Enable the Windows Firewall"
  AddShortcut,StartMenu,%txt_StartMenuFolder_Firewall%,%txt_ShortcutName_FirewallDisable%,"cmd.exe","/C @Echo Disable Firewall... & wpeutil.exe DisableFirewall & pause","#$pWinDir#$p\System32","#$pSystemRoot#$p\system32\imageres.dll",100,"","","Disable the Windows Firewall"
End  

RegUnloadHives

[#ExtractFiles#]
// ===============================================================================================================================
// Name...........: ExtractFiles
// Description....: Builds a list file containing files to extract from install.wim, then uses wimlib to extract to %TargetDir%
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: Called from [Process]
// ===============================================================================================================================
[ExtractFiles]

Echo,"Building a list of required files...#$x#$xThis can take awhile, please be patient."

///////////////////////////////////////////////////////////////////////////////////
// Network List Service
If,%cb_EnableNetworkListService%,Equal,True,Begin
  // net start: SystemSetupInProgress=0 -> net start netprofm -> SystemSetupInProgress=1. netprofm requires wfplwfs.sys for pnidui icon

  RequireFileEx,AppendList,\Windows\System32\networklist\

  RequireFileEx,AppendList,\Windows\System32\ImplatSetup.dll
  RequireFileEx,AppendList,\Windows\System32\netprofm.dll
  RequireFileEx,AppendList,\Windows\System32\netprofmsvc.dll
  RequireFileEx,AppendList,\Windows\System32\nlmgp.dll
  RequireFileEx,AppendList,\Windows\System32\nlmproxy.dll
  RequireFileEx,AppendList,\Windows\System32\nlmsprep.dll
  RequireFileEx,AppendList,\Windows\System32\npmproxy.dll
  RequireFileEx,AppendList,\Windows\System32\pnidui.dll
  RequireFileEx,AppendList,\Windows\System32\Wbem\netprofm.mof
End

///////////////////////////////////////////////////////////////////////////////////
// Network Discovery Services
// Includes Function Discovery Provider Host, Simple Services Discovery Protocol (SSDP),
// Web Services - Discovery (WS-D) protocol, and Universal Plug and Play
If,%cb_EnableNetworkDiscoveryServices%,Equal,True,Begin
  // Function Discovery Provider Host
  RequireFileEx,AppendList,\Windows\System32\fdBth.dll
  RequireFileEx,AppendList,\Windows\System32\fdBthProxy.dll
  RequireFileEx,AppendList,\Windows\System32\FdDevQuery.dll
  RequireFileEx,AppendList,\Windows\System32\fde.dll
  RequireFileEx,AppendList,\Windows\System32\fdeploy.dll
  RequireFileEx,AppendList,\Windows\System32\fdPHost.dll
  RequireFileEx,AppendList,\Windows\System32\fdPnp.dll
  RequireFileEx,AppendList,\Windows\System32\fdprint.dll
  RequireFileEx,AppendList,\Windows\System32\fdProxy.dll
  RequireFileEx,AppendList,\Windows\System32\FDResPub.dll
  RequireFileEx,AppendList,\Windows\System32\fdSSDP.dll
  RequireFileEx,AppendList,\Windows\System32\fdWSD.dll
  RequireFileEx,AppendList,\Windows\System32\WSDApi.dll

  // Simple Services Discovery Protocol (SSDP)
  RequireFileEx,AppendList,\Windows\System32\ssdpapi.dll
  RequireFileEx,AppendList,\Windows\System32\ssdpsrv.dll

  // Universal Plug n' Play Device Host
  RequireFileEx,AppendList,\Windows\System32\upnphost.dll
  RequireFileEx,AppendList,\Windows\System32\upnp.dll
  RequireFileEx,AppendList,\Windows\System32\upnpcont.exe
  RequireFileEx,AppendList,\Windows\System32\upnpui.dll
End

///////////////////////////////////////////////////////////////////////////////////
// Remote Network Driver Interface Specification (RNDIS)
If,%cb_EnableRNDIS%,Equal,True,Begin
  RequireFileEx,AppendList,\Windows\System32\drivers\RNDISMP.sys
  RequireFileEx,AppendList,\Windows\System32\drivers\usb8023.sys

  RequireDriver,netrndis.inf
  RequireDriver,netvwifimp.inf
  RequireDriver,rndiscmp.inf
  RequireDriver,wceisvista.inf

End

///////////////////////////////////////////////////////////////////////////////////
// Drivers (This section could use some cleanup.)
RequireFileEx,AppendList,\Windows\INF\netlldp.inf
RequireFileEx,AppendList,\Windows\INF\ndiscap.inf
RequireFileEx,AppendList,\Windows\INF\netnwifi.inf

RequireFileEx,AppendList,\Windows\System32\drivers\http.sys
RequireFileEx,AppendList,\Windows\System32\drivers\ipfltdrv.sys
RequireFileEx,AppendList,\Windows\System32\drivers\ipnat.sys
RequireFileEx,AppendList,\Windows\System32\drivers\lltdio.sys
RequireFileEx,AppendList,\Windows\System32\drivers\mrxsmb10.sys
RequireFileEx,AppendList,\Windows\System32\drivers\mslldp.sys
RequireFileEx,AppendList,\Windows\System32\drivers\ndiscap.sys
RequireFileEx,AppendList,\Windows\System32\drivers\ndisimplatform.sys
RequireFileEx,AppendList,\Windows\System32\drivers\nwifi.sys
RequireFileEx,AppendList,\Windows\System32\drivers\rspndr.sys
RequireFileEx,AppendList,\Windows\System32\drivers\tcpipreg.sys
RequireFileEx,AppendList,\Windows\System32\drivers\tunnel.sys
RequireFileEx,AppendList,\Windows\System32\drivers\vwififlt.sys
RequireFileEx,AppendList,\Windows\System32\drivers\WdiWiFi.sys
RequireFileEx,AppendList,\Windows\System32\drivers\wfplwfs.sys

RequireFileEx,AppendList,\Windows\System32\DriverStore\FileRepository\netlldp.inf*
RequireFileEx,AppendList,\Windows\System32\DriverStore\FileRepository\netnwifi.inf*
RequireFileEx,AppendList,\Windows\System32\DriverStore\FileRepository\netvwifibus.inf*
RequireFileEx,AppendList,\Windows\System32\DriverStore\FileRepository\netvwififlt.inf*
RequireFileEx,AppendList,\Windows\System32\DriverStore\FileRepository\netvwifimp.inf*

///////////////////////////////////////////////////////////////////////////////////
// Folders
RequireFileEx,AppendList,\ProgramData\Microsoft\WwanSvc
RequireFileEx,AppendList,\Windows\L2Schemas
RequireFileEx,AppendList,\Windows\schemas
RequireFileEx,AppendList,\Windows\System32\icsxml

///////////////////////////////////////////////////////////////////////////////////
// Firewall
// Included in Boot.wim/Winre.wim: bfe.dll, cmifw.dll, firewallapi.dll, fwpuclnt.dll,
// fwremotesvr.dll, mpssvc.dll, sscore.dll, wfapigp.dll
RequireFileEx,AppendList,\Windows\System32\authfwcfg.dll
RequireFileEx,AppendList,\Windows\System32\authfwgp.dll
RequireFileEx,AppendList,\Windows\System32\authfwwizfwk.dll
RequireFileEx,AppendList,\Windows\System32\Firewall.cpl
RequireFileEx,AppendList,\Windows\System32\firewallcontrolpanel.dll
RequireFileEx,AppendList,\Windows\System32\fwcfg.dll
RequireFileEx,AppendList,\Windows\System32\sscoreext.dll
RequireFileEx,AppendList,\Windows\System32\wfhc.dll

///////////////////////////////////////////////////////////////////////////////////
// NetShell (netsh)
// Included in Winre.wim: WcnNetsh.dll
RequireFileEx,AppendList,\Windows\System32\dmcmnutils.dll
RequireFileEx,AppendList,\Windows\System32\HNetMon.dll
RequireFileEx,AppendList,\Windows\System32\mdmregistration.dll
RequireFileEx,AppendList,\Windows\System32\nettrace.dll
RequireFileEx,AppendList,\Windows\System32\nshipsec.dll
RequireFileEx,AppendList,\Windows\System32\nshhttp.dll
RequireFileEx,AppendList,\Windows\System32\P2P.dll
RequireFileEx,AppendList,\Windows\System32\p2pnetsh.dll
RequireFileEx,AppendList,\Windows\System32\peerdistsh.dll
RequireFileEx,AppendList,\Windows\System32\rpcnsh.dll
If,%SourceBaseWimName%,Equal,"Boot.wim",RequireFileEx,AppendList,\Windows\System32\WcnNetsh.dll
RequireFileEx,AppendList,\Windows\System32\whhelper.dll
RequireFileEx,AppendList,\Windows\System32\wwancfg.dll
RequireFileEx,AppendList,\Windows\System32\wwapi.dll

///////////////////////////////////////////////////////////////////////////////////
// CoreMessaging Browser 
// Included in Boot.wim/Winre.wim: fwbase.dll, fwpolicyiomgr.dll, mi.dll
RequireFileEx,AppendList,\Windows\System32\browser.dll
RequireFileEx,AppendList,\Windows\System32\CoreMessaging.dll

///////////////////////////////////////////////////////////////////////////////////
// Share folder 
// Included in Boot.wim/Winre.wim: gpapi.dll, gpsvc.dll, nlaapi.dll, smbwmiv2.dll, wmiclnt.dll
RequireFileEx,AppendList,\Windows\System32\comsvcs.dll
RequireFileEx,AppendList,\Windows\System32\gptext.dll
RequireFileEx,AppendList,\Windows\System32\shacct.dll
RequireFileEx,AppendList,\Windows\System32\shpafact.dll
RequireFileEx,AppendList,\Windows\System32\shrpubw.exe
RequireFileEx,AppendList,\Windows\System32\SMBHelperClass.dll

///////////////////////////////////////////////////////////////////////////////////
// Passwords 
// Included in Boot.wim/Winre.wim: credui.dll, credprovhost.dll, credprovs.dll, DWrite.dll
RequireFileEx,AppendList,\Windows\System32\credssp.dll

///////////////////////////////////////////////////////////////////////////////////
// dot3svc
// (additional files: dot3gpui.dll,dot3ui.dll,onexui.dll,Dot3Conn.dll)
RequireFileEx,AppendList,\Windows\System32\dot3api.dll
RequireFileEx,AppendList,\Windows\System32\dot3cfg.dll
RequireFileEx,AppendList,\Windows\System32\dot3dlg.dll
RequireFileEx,AppendList,\Windows\System32\dot3gpclnt.dll
RequireFileEx,AppendList,\Windows\System32\dot3gpui.dll
RequireFileEx,AppendList,\Windows\System32\dot3hc.dll
RequireFileEx,AppendList,\Windows\System32\dot3msm.dll
RequireFileEx,AppendList,\Windows\System32\dot3svc.dll
RequireFileEx,AppendList,\Windows\System32\dot3ui.dll
RequireFileEx,AppendList,\Windows\System32\l2gpstore.dll
RequireFileEx,AppendList,\Windows\System32\l2nacp.dll
RequireFileEx,AppendList,\Windows\System32\onex.dll
RequireFileEx,AppendList,\Windows\System32\onexui.dll

///////////////////////////////////////////////////////////////////////////////////
// Control
RequireFileEx,AppendList,\Windows\System32\IEAdvpack.dll
RequireFileEx,AppendList,\Windows\System32\ieframe.dll
RequireFileEx,AppendList,\Windows\System32\shwebsvc.dll
RequireFileEx,AppendList,\Windows\System32\mshtml.dll

///////////////////////////////////////////////////////////////////////////////////
// Misc
RequireFileEx,AppendList,\Windows\System32\certenc.dll
RequireFileEx,AppendList,\Windows\System32\fdWNet.dll
RequireFileEx,AppendList,\Windows\System32\inetcomm.dll
RequireFileEx,AppendList,\Windows\System32\iphlpsvc.dll
RequireFileEx,AppendList,\Windows\System32\msi.dll
RequireFileEx,AppendList,\Windows\System32\msvfw32.dll
RequireFileEx,AppendList,\Windows\System32\networkitemfactory.dll
RequireFileEx,AppendList,\Windows\System32\PortableDeviceApi.dll
RequireFileEx,AppendList,\Windows\System32\prnfldr.dll
RequireFileEx,AppendList,\Windows\System32\TSpkg.dll
RequireFileEx,AppendList,\Windows\System32\Windows.UI.Cred.dll

///////////////////////////////////////////////////////////////////////////////////
// Map a network drive
RequireFileEx,AppendList,\Windows\System32\netplwiz.dll

///////////////////////////////////////////////////////////////////////////////////
// Control Panel
RequireFileEx,AppendList,\Windows\System32\hgcpl.dll
RequireFileEx,AppendList,\Windows\System32\inetcpl.cpl
RequireFileEx,AppendList,\Windows\System32\netcenter.dll
RequireFileEx,AppendList,\Windows\System32\netdiagfx.dll
RequireFileEx,AppendList,\Windows\System32\netid.dll

///////////////////////////////////////////////////////////////////////////////////
// Windows Firewall/Internet Connection Sharing (ICS) Service
RequireFileEx,AppendList,\Windows\System32\ipnathlp.dll
RequireFileEx,AppendList,\Windows\System32\icsigd.dll
RequireFileEx,AppendList,\Windows\System32\icsunattend.exe

///////////////////////////////////////////////////////////////////////////////////
// Network Diagnostic
RequireFileEx,AppendList,\Windows\System32\ndfapi.dll
RequireFileEx,AppendList,\Windows\System32\ndfetw.dll
RequireFileEx,AppendList,\Windows\System32\NdfEventView.xml
RequireFileEx,AppendList,\Windows\System32\ndfhcdiscovery.dll

///////////////////////////////////////////////////////////////////////////////////
// File Sharing 
// Included in Boot.wim/Winre.wim: mpr.dll, mprapi.dll, mprmsg.dll, rtutils.dll
// optional: netplwiz.dll, Netplwiz.exe
RequireFileEx,AppendList,\Windows\System32\iprtprio.dll
RequireFileEx,AppendList,\Windows\System32\iprtrmgr.dll
RequireFileEx,AppendList,\Windows\System32\mprddm.dll
RequireFileEx,AppendList,\Windows\System32\mprdim.dll
RequireFileEx,AppendList,\Windows\System32\networkexplorer.dll
RequireFileEx,AppendList,\Windows\System32\NetworkStatus.dll
RequireFileEx,AppendList,\Windows\System32\rtm.dll

///////////////////////////////////////////////////////////////////////////////////
// SMB
// Included in Boot.wim/Winre.wim: wkscli.dll, wkssvc.dll
RequireFileEx,AppendList,\Windows\System32\wkspbrokerax.dll
RequireFileEx,AppendList,\Windows\System32\wksprtps.dll

///////////////////////////////////////////////////////////////////////////////////
// NlaSvc
// Included in Boot.wim/Winre.wim: nlaapi.dll, nlasvc.dll, rasapi32.dll, tapi32.dll
RequireFileEx,AppendList,\Windows\System32\nlahc.dll

///////////////////////////////////////////////////////////////////////////////////
// Telephony
// Included in Boot.wim/Winre.wim: tapi32.dll
RequireFileEx,AppendList,\Windows\System32\tapisrv.dll
RequireFileEx,AppendList,\Windows\System32\TapiUnattend.exe

///////////////////////////////////////////////////////////////////////////////////
// Security Components
RequireFileEx,AppendList,\Windows\System32\Keymgr.dll
RequireFileEx,AppendList,\Windows\System32\Msaudite.dll

///////////////////////////////////////////////////////////////////////////////////
// Service Control
RequireFileEx,AppendList,\Windows\System32\sc.exe

///////////////////////////////////////////////////////////////////////////////////
// Service logon
RequireFileEx,AppendList,\Windows\System32\seclogon.dll

///////////////////////////////////////////////////////////////////////////////////
// TCPIP support 
// Included in Boot.wim/Winre.wim: esent.dll, scecli.dll
RequireFileEx,AppendList,\Windows\System32\ubpm.dll

///////////////////////////////////////////////////////////////////////////////////
// Van NetStatus
RequireFileEx,AppendList,\Windows\System32\VAN.dll
RequireFileEx,AppendList,\Windows\System32\WlanRadioManager.dll

///////////////////////////////////////////////////////////////////////////////////
// Airplane mode
RequireFileEx,AppendList,\Windows\System32\RMapi.dll

///////////////////////////////////////////////////////////////////////////////////
// WcmSvc
// Included in Boot.wim/Winre.wim: nlaapi.dll
RequireFileEx,AppendList,\Windows\System32\wcmapi.dll
RequireFileEx,AppendList,\Windows\System32\wcmcsp.dll
RequireFileEx,AppendList,\Windows\System32\wcmsvc.dll
RequireFileEx,AppendList,\Windows\System32\NetworkUXBroker.dll

///////////////////////////////////////////////////////////////////////////////////
// WcncSvc
RequireFileEx,AppendList,\Windows\System32\WcnApi.dll
RequireFileEx,AppendList,\Windows\System32\wcncsvc.dll
RequireFileEx,AppendList,\Windows\System32\WcnEapAuthProxy.dll
RequireFileEx,AppendList,\Windows\System32\WcnNetsh.dll
RequireFileEx,AppendList,\Windows\System32\wcnwiz.dll

///////////////////////////////////////////////////////////////////////////////////
// EapHost
// Included in Boot.wim/Winre.wim: Eap3Host.exe, eapp3hst.dll, eappcfg.dll, eappgnui.dll,
// eapphost.dll, eappprxy.dll, eapprovp.dll, eapsvc.dll, keyiso.dll, ttlsauth.dll,ttlscfg.dll
RequireFileEx,AppendList,\Windows\System32\cngcredui.dll
RequireFileEx,AppendList,\Windows\System32\cngprovider.dll

///////////////////////////////////////////////////////////////////////////////////
// Wlan
// additional: wlangpui.dll, provcore.dll
RequireFileEx,AppendList,\Windows\System32\mobilenetworking.dll
RequireFileEx,AppendList,\Windows\System32\wlanapi.dll
RequireFileEx,AppendList,\Windows\System32\wlancfg.dll
RequireFileEx,AppendList,\Windows\System32\WLanConn.dll
RequireFileEx,AppendList,\Windows\System32\wlandlg.dll
RequireFileEx,AppendList,\Windows\System32\wlanext.exe
RequireFileEx,AppendList,\Windows\System32\wlanhlp.dll
RequireFileEx,AppendList,\Windows\System32\WLanHC.dll
RequireFileEx,AppendList,\Windows\System32\wlanhlp.dll
RequireFileEx,AppendList,\Windows\System32\WlanMediaManager.dll
RequireFileEx,AppendList,\Windows\System32\WlanMM.dll
RequireFileEx,AppendList,\Windows\System32\wlanmsm.dll
RequireFileEx,AppendList,\Windows\System32\wlanpref.dll
RequireFileEx,AppendList,\Windows\System32\wlansec.dll
RequireFileEx,AppendList,\Windows\System32\wlansvc.dll
RequireFileEx,AppendList,\Windows\System32\wlansvcpal.dll
RequireFileEx,AppendList,\Windows\System32\wlanui.dll
RequireFileEx,AppendList,\Windows\System32\wlanutil.dll

///////////////////////////////////////////////////////////////////////////////////
// Wlan password 
// additional: fdProxy.dll, webcheck.dll
RequireFileEx,AppendList,\Windows\System32\fdWCN.dll
RequireFileEx,AppendList,\Windows\System32\fundisc.dll
RequireFileEx,AppendList,\Windows\System32\Windows.Globalization.dll
RequireFileEx,AppendList,\Windows\System32\winhttp.dll

///////////////////////////////////////////////////////////////////////////////////
// Net event
RequireFileEx,AppendList,\Windows\System32\netevent.dll

///////////////////////////////////////////////////////////////////////////////////
// Network Location
RequireFileEx,AppendList,\Windows\System32\shwebsvc.dll 

///////////////////////////////////////////////////////////////////////////////////
// Network Tray icon - Win11 24H2+
If,%SourceVer%,BiggerEqual,10.0.26100.0,RequireFileEx,AppendList,\Windows\System32\NetworkIcon.dll


///////////////////////////////////////////////////////////////////////////////////
// Resources
RequireFileEx,AppendList,\Windows\System32\wbem\nlasvc.mof
RequireFileEx,AppendList,\Windows\System32\wbem\wlan.mof
RequireFileEx,AppendList,\Windows\SystemResources\Windows.UI.Cred\Windows.UI.Cred.pri
RequireFileEx,AppendList,\Windows\SystemResources\Windows.UI.Cred\pris\Windows.UI.Cred*

///////////////////////////////////////////////////////////////////////////////////
// Extract
RequireFileEx,ExtractList

[#Config-Network#]
// ===============================================================================================================================
// Name...........: Config-Network
// Description....: Register network components.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: Called from [Process]
// ===============================================================================================================================
[Config-Network]
Echo,"Configuring network support..."

///////////////////////////////////////////////////////////////////////////////////
// Network List Service

If,%cb_EnableNetworkListService%,Equal,True,Begin
  // Use NetworkSetup2 and NetworkUxManager 
  If,ExistFile,"%TargetSystem32%\tsdiscon.exe",Begin
    RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\NetworkSetup2",HKLM,"Tmp_System\ControlSet001\Control\NetworkSetup2"
  End
  Else,Begin
    RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\NetworkSetup2\Filters",HKLM,"Tmp_System\ControlSet001\Control\NetworkSetup2\Filters"
	// Remove QoS Packet Scheduler (ms_pacer filter)
	RegDelete,HKLM,"Tmp_System\ControlSet001\Control\NetworkSetup2\Filters\{B5F4D659-7DAA-4565-8E41-BE220ED60542}"
	RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\NetworkSetup2\Plugins",HKLM,"Tmp_System\ControlSet001\Control\NetworkSetup2\Plugins"
  End
  
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\NetworkUXManager",HKLM,"Tmp_System\ControlSet001\Control\NetworkUXManager"
  
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows NT\CurrentVersion\NetworkList",HKLM,"Tmp_Software\Microsoft\Windows NT\CurrentVersion\NetworkList"

  // AllowStart Network List Service
  // netprofm requires SystemSetupInProgress=0 > net start netprofm > SystemSetupInProgress=1
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\netprofm",HKLM,"Tmp_System\ControlSet001\Services\netprofm"
  RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\netprofm","Start",3
  RegWrite,HKLM,REG_NONE,"Tmp_System\Setup\AllowStart\netprofm"

  // Permissions:
	
  // NetworkList Files:
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$q%TargetSystem32%\networklist#$q -ot file -actn ace -ace #$qn:%SID-Netprofm%;p:full;s:y#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$x%TargetSystem32%\networklist#$x#$xThe command returned: %ExitCode%"

  // NetworkList\:
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList#$q -ot reg -actn ace -ace #$qn:%SID-Netprofm%;p:full;s:y#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList#$x#$xThe command returned: %ExitCode%"

  // NetworkList\Nla:
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Nla#$q -ot reg -actn ace -ace #$qn:%SID-NlaSvc%;p:full;s:y#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Nla#$x#$xThe command returned: %ExitCode%"

  // NetworkList\Permissions:
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$q -ot reg -actn ace -ace #$qn:%SID-WwanSvc%;p:full;s:y#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$x#$xThe command returned: %ExitCode%"

  // Unknown account S-1-5-32-556
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$q -ot reg -actn ace -ace #$qn:%SID-UnknownAccount1%;p:full#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$x#$xThe command returned: %ExitCode%"

  // Unknown account: S-1-5-92-1467204242-1103346305-4253404563-2848856930-0
  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$q -ot reg -actn ace -ace #$qn:%SID-UnknownAccount2%;p:full#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$x#$xThe command returned: %ExitCode%"

  ShellExecute,Hide,%Tools%\%HostArch%\SetAcl.exe,"-on #$qHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$q -ot reg -actn ace -ace #$qn:Everyone;p:full;s:y#$q"
  If,Not,%ExitCode%,Equal,0,Halt,"Error: Could not grant permissions on: #$xHKLM\Tmp_software\Microsoft\Windows NT\CurrentVersion\NetworkList\Permissions#$x#$xThe command returned: %ExitCode%"

End
Else,Begin
  // netprofm service is required for wlansvc and wcmsvc service in 1903 even disabled and not started.
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\netprofm",HKLM,"Tmp_System\ControlSet001\Services\netprofm"
  RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\netprofm","Start",4
End

// End Network List Service
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
// Network Discovery Services

If,%cb_EnableNetworkDiscoveryServices%,Equal,True,Begin
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\fdPHost",HKLM,"Tmp_System\ControlSet001\Services\fdPHost"
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\FDResPub",HKLM,"Tmp_System\ControlSet001\Services\FDResPub"
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\SSDPSRV",HKLM,"Tmp_System\ControlSet001\Services\SSDPSRV"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Function Discovery",HKLM,"Tmp_Software\Microsoft\Function Discovery"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\UPnP Device Host",HKLM,"Tmp_Software\Microsoft\UPnP Device Host"
  RegCopy,HKLM,"Tmp_Install_Software\Classes\NetworkExplorerPlugins",HKLM,"Tmp_Software\Classes\NetworkExplorerPlugins"

  // Plug n Play Service
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\upnphost",HKLM,"Tmp_System\ControlSet001\Services\upnphost"

  // Network Icon in File Explorer Navigation Tree
  RegCopy,HKLM,"Tmp_Install_Software\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}",HKLM,"Tmp_Software\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}"
End

// End Network Discovery Services
///////////////////////////////////////////////////////////////////////////////////

If,Not,%RegistrySoftwareSource%,Equal,"Install.wim",Begin
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\WlanSvc",HKLM,"Tmp_Software\Microsoft\WlanSvc"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\wcmsvc",HKLM,"Tmp_Software\Microsoft\wcmsvc"
  RegCopy,HKLM,"Tmp_Install_Software\Policies\Microsoft\Windows\WcmSvc",HKLM,"Tmp_Software\Policies\Microsoft\Windows\WcmSvc"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\SettingSync\WindowsSettingHandlers\Tethering",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\SettingSync\WindowsSettingHandlers\Tethering"
  System,ErrorOff,7
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{01578f96-c270-4602-ade0-578d9c29fc0c}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{01578f96-c270-4602-ade0-578d9c29fc0c}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{017ba13c-9a55-4f1f-8200-323055aac810}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{017ba13c-9a55-4f1f-8200-323055aac810}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{67d07935-283a-4791-8f8d-fa9117f3e6f2}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{67d07935-283a-4791-8f8d-fa9117f3e6f2}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{9580d7dd-0379-4658-9870-d5be7d52d6de}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{9580d7dd-0379-4658-9870-d5be7d52d6de}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{b92cf7fd-dc10-4c6b-a72d-1613bf25e597}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{b92cf7fd-dc10-4c6b-a72d-1613bf25e597}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{c100becc-d33a-4a4b-bf23-bbef4663d017}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{c100becc-d33a-4a4b-bf23-bbef4663d017}"
  RegCopy,HKLM,"Tmp_Install_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{c100becf-d33a-4a4b-bf23-bbef4663d017}",HKLM,"Tmp_Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{c100becf-d33a-4a4b-bf23-bbef4663d017}"
End

// WinPE-WiFi-Package related
If,%SourceBaseWimName%,Equal,"Boot.wim",Begin
  // Included in Winre.wim: HKLM\Tmp_System\ControlSet001\Services\tdx, HKLM\Tmp_System\ControlSet001\Services\vwifibus
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\tdx",HKLM,"Tmp_System\ControlSet001\Services\tdx"
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\vwifibus",HKLM,"Tmp_System\ControlSet001\Services\vwifibus"
  
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{5CBF81BF-5055-47CD-9055-A76B2B4E3698}",HKLM,"Tmp_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{5CBF81BF-5055-47CD-9055-A76B2B4E3698}"

  //RegWrite,HKLM,0x7,"Tmp_System\ControlSet001\Services\vwifibus","Owners","netvwifibus.inf"

  // Included in Winre.wim: HKLM\Tmp_System\ControlSet001\Services\vwififlt
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\vwififlt",HKLM,"Tmp_System\ControlSet001\Services\vwififlt"

  // Included in Winre.wim: HKLM\Tmp_System\ControlSet001\Services\wcncsvc, HKLM\Tmp_System\ControlSet001\Services\wdiwifi
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\wcncsvc",HKLM,"Tmp_System\ControlSet001\Services\wcncsvc"
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\wdiwifi",HKLM,"Tmp_System\ControlSet001\Services\wdiwifi"
  
  // Included in Winre.wim: HKLM\Tmp_System\ControlSet001\Services\NativeWifiP
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\NativeWifiP",HKLM,"Tmp_System\ControlSet001\Services\NativeWifiP"

  // Included in Winre.wim (Partial): HKLM\Tmp_System\ControlSet001\Services\WinSock, HKLM\Tmp_System\ControlSet001\Services\WinSock2
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\WinSock",HKLM,"Tmp_System\ControlSet001\Services\WinSock"
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\WinSock2",HKLM,"Tmp_System\ControlSet001\Services\WinSock2"
  
  RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\WMI\Autologger\WiFiSession",HKLM,"Tmp_System\ControlSet001\Control\WMI\Autologger\WiFiSession"
End

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\WlanSvc",HKLM,"Tmp_System\ControlSet001\Services\WlanSvc"
RegWrite,HKLM,0x7,"Tmp_System\ControlSet001\Services\WlanSvc","DependOnService","nativewifip","RpcSs","Ndisuio","wcmsvc",NOWARN

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\Wcmsvc",HKLM,"Tmp_System\ControlSet001\Services\Wcmsvc"

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\LanmanWorkstation",HKLM,"Tmp_System\ControlSet001\Services\LanmanWorkstation"
RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\LanmanWorkstation\Parameters","AllowInsecureGuestAuth",1

// Removed in 10.0.26040.1000
System,ErrorOff,1
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\NetTrace\Scenarios\WLAN",HKLM,"Tmp_System\ControlSet001\Control\NetTrace\Scenarios\WLAN"

If,%SourceVer%,BiggerEqual,10.0.17000.0,Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\WlanSvc","ErrorControl",1
  RegWrite,HKLM,REG_EXPAND_SZ,"Tmp_System\ControlSet001\Services\WlanSvc","ImagePath","#$pSystemRoot#$p\System32\Svchost.exe -k LocalSystemNetworkRestricted -p"
  RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\WlanSvc","Start",2
  RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\WlanSvc","Type",32
End

// wfplwfs
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{3BFD7820-D65C-4C1B-9FEA-983A019639EA}",HKLM,"Tmp_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{3BFD7820-D65C-4C1B-9FEA-983A019639EA}"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{B70D6460-3635-4D42-B866-B8AB1A24454C}",HKLM,"Tmp_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{B70D6460-3635-4D42-B866-B8AB1A24454C}"
If,%SourceArch%,Equal,x64,RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{E7C3B2F0-F3C5-48DF-AF2B-10FED6D72E7A}",HKLM,"Tmp_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{E7C3B2F0-F3C5-48DF-AF2B-10FED6D72E7A}"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\WFPLWFS",HKLM,"Tmp_System\ControlSet001\Services\WFPLWFS"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{E475CF9A-60CD-4439-A75F-0079CE0E18A1}",HKLM,"Tmp_System\ControlSet001\Control\Network\{4d36e974-e325-11ce-bfc1-08002be10318}\{E475CF9A-60CD-4439-A75F-0079CE0E18A1}"

// Holger: Fix WFPLWFS and both services nativewifip, wlanscv.
RegWrite,HKLM,REG_SZ,"Tmp_System\ControlSet001\Control\NetworkSetup2\Filters\{3BFD7820-D65C-4C1B-9FEA-983A019639EA}\Kernel","FilterClass","ms_medium_converter_top"
RegWrite,HKLM,REG_SZ,"Tmp_System\ControlSet001\Control\NetworkSetup2\Filters\{B70D6460-3635-4D42-B866-B8AB1A24454C}\Kernel","FilterClass","ms_medium_converter_top"
RegWrite,HKLM,REG_SZ,"Tmp_System\ControlSet001\Control\NetworkSetup2\Filters\{E475CF9A-60CD-4439-A75F-0079CE0E18A1}\Kernel","FilterClass","ms_medium_converter_top"

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\RadioManagement",HKLM,"Tmp_System\ControlSet001\Control\RadioManagement"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\VAN",HKLM,"Tmp_System\ControlSet001\Control\VAN"

// Included in Winre.wim: HKLM\Tmp_System\ControlSet001\Control\wcncsvc
If,%SourceBaseWimName%,Equal,"Boot.wim",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\wcncsvc",HKLM,"Tmp_System\ControlSet001\Control\wcncsvc"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Winlogon\Notifications\Components\Dot3svc",HKLM,"Tmp_System\ControlSet001\Control\Winlogon\Notifications\Components\Dot3svc"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Control\Winlogon\Notifications\Components\Wlansvc",HKLM,"Tmp_System\ControlSet001\Control\Winlogon\Notifications\Components\Wlansvc"

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\bowser",HKLM,"Tmp_System\ControlSet001\Services\bowser"
If,ExistRegSubKey,HKLM,"Tmp_Install_System\ControlSet001\Services\Browser",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\Browser",HKLM,"Tmp_System\ControlSet001\Services\Browser"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\dot3svc",HKLM,"Tmp_System\ControlSet001\Services\dot3svc"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\EapHost",HKLM,"Tmp_System\ControlSet001\Services\EapHost"
If,ExistRegSubKey,HKLM,"Tmp_Install_System\ControlSet001\Services\EventLog\System\Browser",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\EventLog\System\Browser",HKLM,"Tmp_System\ControlSet001\Services\EventLog\System\Browser"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\EventLog\System\Microsoft-Windows-WLAN-AutoConfig",HKLM,"Tmp_System\ControlSet001\Services\EventLog\System\Microsoft-Windows-WLAN-AutoConfig"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\IPNAT",HKLM,"Tmp_System\ControlSet001\Services\IPNAT"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\IpFilterDriver",HKLM,"Tmp_System\ControlSet001\Services\IpFilterDriver"
// In WinRE.wim: HKLM\Tmp_System\ControlSet001\Services\HTTP
If,%SourceBaseWimName%,Equal,"Boot.wim",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\HTTP",HKLM,"Tmp_System\ControlSet001\Services\HTTP"

RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\HTTP\Parameters\UrlAclInfo",HKLM,"Tmp_System\ControlSet001\Services\HTTP\Parameters\UrlAclInfo"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\NdisCap",HKLM,"Tmp_System\ControlSet001\Services\NdisCap"
// In WinRE.wim: HKLM\Tmp_System\ControlSet001\Services\NlaSvc
If,%SourceBaseWimName%,Equal,"Boot.wim",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\NlaSvc",HKLM,"Tmp_System\ControlSet001\Services\NlaSvc"

// Internet Connection Sharing (ICS)
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\SharedAccess",HKLM,"Tmp_System\ControlSet001\Services\SharedAccess"
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\tcpipreg",HKLM,"Tmp_System\ControlSet001\Services\tcpipreg"
RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\TCPIPTUNNEL","NdisMajorVersion",6
RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\TCPIPTUNNEL","NdisMinorVersion",40
RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\TCPIPTUNNEL","DriverMajorVersion",0
RegWrite,HKLM,REG_DWORD,"Tmp_System\ControlSet001\Services\TCPIPTUNNEL","DriverMinorVersion",0

// Telephony service
RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\TapiSrv",HKLM,"Tmp_System\ControlSet001\Services\TapiSrv"

// iSCSI
If,%SourceBaseWimName%,Equal,"Boot.wim",RegCopy,HKLM,"Tmp_Install_System\ControlSet001\Services\MSiSCSI",HKLM,"Tmp_System\ControlSet001\Services\MSiSCSI"

RegWrite,HKLM,REG_NONE,"Tmp_System\Setup\AllowStart\dnscache"
RegWrite,HKLM,REG_NONE,"Tmp_System\Setup\AllowStart\nlasvc"
RegWrite,HKLM,REG_NONE,"Tmp_System\Setup\AllowStart\wcmsvc"
RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\StuckRects3","Settings",30,00,00,00,fe,ff,ff,ff,02,00,00,00,03,00,00,00,3e,00,00,00,28,00,00,00,00,00,00,00,f2,03,00,00,90,06,00,00,1a,04,00,00,60,00,00,00,01,00,00,00

// Fix blank Wifi Network List in 24H2 (Issue #147)
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\Capabilities\wlanLocationBypass","RequireWindowsCert",0

[#SetDefaultOptions#]
// ===============================================================================================================================
// Name...........: SetDefaultOptions
// Description....: Sets script options to default values.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........: 
// Related........: btn_SetDefaultOptions
// ===============================================================================================================================
[SetDefaultOptions]
System,Cursor,Wait
WriteInterface,Value,%ScriptFile%,Interface,cb_EnableNetworkListService,True
WriteInterface,Value,%ScriptFile%,Interface,cb_EnableNetworkDiscoveryServices,True
WriteInterface,Value,%ScriptFile%,Interface,cb_EnableRNDIS,False

WriteInterface,Value,%ScriptFile%,Interface,cb_DesktopShc_InitNetwork,False
WriteInterface,Value,%ScriptFile%,Interface,cb_StartMenuShc_InitNetwork,True
WriteInterface,Value,%ScriptFile%,Interface,txt_StartMenuFolder_InitNetwork,"Networking"
WriteInterface,Value,%ScriptFile%,Interface,txt_ShortcutName_InitNetwork,"Initialize Network"

WriteInterface,Value,%ScriptFile%,Interface,cb_DesktopShc_Firewall,False
WriteInterface,Value,%ScriptFile%,Interface,cb_StartMenuShc_Firewall,False
WriteInterface,Value,%ScriptFile%,Interface,txt_StartMenuFolder_Firewall,"Networking"
WriteInterface,Value,%ScriptFile%,Interface,txt_ShortcutName_FirewallEnable,"Enable Firewall"
WriteInterface,Value,%ScriptFile%,Interface,txt_ShortcutName_FirewallDisable,"Disable Firewall"

System,Cursor,Normal

[#ToggleAdvancedOptions#]
// ===============================================================================================================================
// Name...........: ToggleAdvancedOptions
// Description....: Show/Hide advanced options.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........: btn_AdvancedOptions
// ===============================================================================================================================
[ToggleAdvancedOptions]
Message,"There are no advanced options available for this script."

[#ShowScriptInfo#]
// ===============================================================================================================================
// Name...........: ShowScriptInfo
// Description....: 
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........: btn_ScriptInfo
// ===============================================================================================================================
[ShowScriptInfo]
Message,"This script provides core network support for WinPE."

[#Interface#]
// ===============================================================================================================================
// Name...........: Interface
// Description....: 
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: 
// ===============================================================================================================================
[Interface]
btn_SetDefaultOptions=,1,8,543,5,25,25,SetDefaultOptions,SetDefaults_16.png,True,"__Restore Defaults"
btn_AdvancedOptions=,1,8,574,5,25,25,ToggleAdvancedOptions,Advanced_Disabled_16.png,True,"__Show Advanced Options"
btn_ScriptInfo=,1,8,605,5,25,25,ShowScriptInfo,Help_16.png,True,"__Script Info"

cb_EnableNetworkListService="Enable the Network List Service",1,3,5,50,200,18,True,"__This service Identifies the networks to which the computer has connected,#$xcollects and stores properties for these networks,#$xand notifies applications when these properties change."
cb_EnableNetworkDiscoveryServices="Enable Network Discovery Services",1,3,5,70,200,18,True,"__Enable Network Discovery, SSDP, and Universal PnP services."
cb_EnableRNDIS="Enable Remote Network Driver Interface Specification (RNDIS)",1,3,5,90,319,18,False,"__RNDIS can provide a virtual Ethernet link over USB, allowing you to use a mobile device as a modem/hotspot."

bvl_Shortcuts_InitNetwork="Initialize Network",1,12,5,250,133,184,8,Bold
cb_DesktopShc_InitNetwork=Desktop,1,3,12,263,122,18,False
cb_StartMenuShc_InitNetwork="Start Menu",1,3,12,282,122,18,True
txt_StartMenuFolder_InitNetwork="Start Menu folder:",1,0,12,361,119,21,Networking
txt_ShortcutName_InitNetwork="Shortcut Name:",1,0,12,403,119,21,"Initialize Network"

bvl_Shortcuts_Firewall=Firewall,1,12,150,250,133,184,8,Bold
cb_DesktopShc_Firewall=Desktop,1,3,157,263,122,18,False
cb_StartMenuShc_Firewall="Start Menu",1,3,157,282,122,18,False
txt_StartMenuFolder_Firewall="Start Menu folder:",1,0,157,319,119,21,Networking
txt_ShortcutName_FirewallEnable="Shortcut Name (Enable):",1,0,157,361,119,21,"Enable Firewall"
txt_ShortcutName_FirewallDisable="Shortcut Name (Disable):",1,0,157,403,119,21,"Disable Firewall"

[InterfaceEncoded]
SetDefaults_16.png=2475,3404
Help_16.png=2830,3868
Advanced_Disabled_16.png=474,744

[AuthorEncoded]
Network_80.png=14183,19012
Logo=Network_80.png

[EncodedFile-InterfaceEncoded-SetDefaults_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHEGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTEwLTIxVDE3OjIxOjEyLTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMWM3ZDhlNS1mMGMxLTMwNDgtOGNiOS03YWU4YjgyNDgyNmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDowNzhkNDM1MC04NWRmLTg4NDQtOTY0Mi1lYTIxNmU3YjUwNDIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMDM1MDg3Mi1hYmUxLWU5NDAtOTE2NC1kYzRjMzdjOGIwOTUiPiA8ZGM6Y3JlYXRvcj4gPHJkZjpTZXE+IDxyZGY6bGk+SG9tZXMzMjwvcmRmOmxpPiA8L3JkZjpTZXE+IDwvZGM6Y3JlYXRvcj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmMDM1MDg3Mi1hYmUxLWU5NDAtOTE2NC1kYzRjMzdjOGIwOTUiIHN0RXZ0OndoZW49IjIwMTktMTAtMjFUMTc6MjE6MTItMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDdmNDNiMDctMTg1NC1hNjQwLWEwM2UtYTQxMTM2YTA0ODA2IiBzdEV2dDp3aGVuPSIyMDE5LTEwLTIxVDE3OjIxOjQ3LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmIxYzdkOGU1LWYwYzEtMzA0OC04Y2I5LTdhZThiODI0ODI2ZCIgc3RFdnQ6d2hlbj0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlYy9voAAAJBSURBVDiNpdHLThNRHAbwvkCjpalcSyyUEDo09Jw5MxZeggXdQHSpa96ARTclolWpLYtG20IDwdpaoeVOW63G0gvEmEaj3cFKYrxMXLjw88wAbQ3smOQ3OTn/73yZiw6A7jK0G9tjJ0rcPmtnB8zNFbnjU0VtT52VWD1/UcE4KzOFw39K3D6D44NDYRWeOVdQYKoxDue8YxjeH4b1lRXm5S70v+7HSHlkjO83FeSZkcNFnAUnDFsGuOIu7L0v4M7GbXRlusDeMGO9QMyIHikrYSA7ACEnQF2LuyLkrIzuTDd6Q704rB1CvabWp6B/qYeYFT31AmlTqtrX7XAmb2AwLsCyZoFz2wn7th2GqAHxfEI7nM6voW2+DY4dB8QNsVovsKVsCl2myOXyGrpA0LHSAWOsBZOxSeAL8LH0GWJYRGeyE/KqDHFFVOoFQkJQBucFpFNb+JH/gxeJFMx+M4SADW/TZdR2jnAzdAtXo1cgJ2XQ51TVKGBLrGqJXofkl7C5uotvld9YiC/hSSyCr8VfmF6cQcucAUPPhkAX6ZnGK9Aw9UhRCdeCJhAvQblwAPzkk+9ApXgA6z0rLGELWISBRuiZxkckQWLkIIUkGH1G9Ln7UPtUA/4Co75R6O/rIT2VoGaaNH4jmSM6EiAu4ieQgzJava2QZ2RMBCZgvmsGDVLweTOXeqZR8Jic8JFx8ogosl9Gj7cHpmkTqJ8/7iwvmCUqRcuc5i8q0JGHpJ08IG6uyB1rvNrarc18RHeu4DL+AeXUQV071uymAAAAAElFTkSuQmCCeJwTCk4tcUlNSyzNKSmONzTTK8hLZxgFIwes5sQv/03zkSgjAwBGXgl7UO9x9wEAAAACAAAAKgAAAKsJAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-Help_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHAWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0wMi0yMlQxNjo1OTo1MC0wNjowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTktMTItMDJUMjE6NTM6MDQtMDY6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMTItMDJUMjE6NTM6MDQtMDY6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YWQ2OTFmMzItY2FiZC1hZTQzLTlmNjAtMzk5YjQyOTBlMTNiIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6OTBjZmFlNjAtYWJhZS1iNTQ3LWIyODEtOWYxNzg2YzM1NjQ2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MzUwYTZiYzMtZDFiMi03MjRjLTlmZWQtY2RmYTM4YzhjM2FkIj4gPGRjOmNyZWF0b3I+IDxyZGY6U2VxPiA8cmRmOmxpPkhvbWVzMzI8L3JkZjpsaT4gPC9yZGY6U2VxPiA8L2RjOmNyZWF0b3I+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MzUwYTZiYzMtZDFiMi03MjRjLTlmZWQtY2RmYTM4YzhjM2FkIiBzdEV2dDp3aGVuPSIyMDE4LTAyLTIyVDE2OjU5OjUwLTA2OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MmNhNWFiYy05Mzg0LWUwNGYtOGE5NC0yMTk1NjY1NjY1YTUiIHN0RXZ0OndoZW49IjIwMTgtMDItMjJUMTc6MTA6MDUtMDY6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmFkNjkxZjMyLWNhYmQtYWU0My05ZjYwLTM5OWI0MjkwZTEzYiIgc3RFdnQ6d2hlbj0iMjAxOS0xMi0wMlQyMTo1MzowNC0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PozE0ngAAAOzSURBVDgRBcF9TJR1AMDx7/N7nnuOez/kxUJe4q2pWEgoykxLpqkzx6bhlszN/soZ/dE0W9bWZrVZ2WYt/ypn5VrmzDkZZk2INoRyNJEUUDg4TuC4g7vjjrvjHu7uefp8pJljb2KymMlr2g5rq5H0ZQj6V+mzwYOh4qrGbDyadqN1GfOhK7Hp2cV4VQWRE5+SF42QUVUUAEOSkDJZsMvuQEg68/OgfOBPjzvf4xnDpArW1xQe2rxS/XB/Q8kPzlnv6blYXJeEAEB+Z8MGTOllrE0b13V4uXXk3NDuS3/4rYmoTnGeDUk30f1PkNvDmntQz3/5mecKm2o8//6WGByNY7ehmI0Mec9Xlvw6rf51+Mv7K3IzBmff2sgbB2rJdZpJpZa5NzzJR+fv0dMxwqPZqq0XT37cvqbo/JapvpFl+fPtGxhv2PHjkauxuqJMFpdL5qtTO3A7ZMa8fnJtBmUlKissaR75UmgzER66K4qa1ttVqafvttBLi9d868lpTvkXWVloxunI4cLVfg6/e43GQ9c4e3GAWCDECjVJYikBqsTd30e4mSw9aq0tt4ontvx9vZ4lCi0SmayO2ST45dYYfQNR5r0ZkokkTruG50mYwcdRYnGNwHiQjmHdpW3b2iYixZV74sFFTMJAUWQkIZHSdHwTi5w8VsXpo2WMjgU5ezmA1e7G5bCQ67IyN7FApm7TdpFWFIvIGiiKjCwkxn0R7g/O09pSzmfHy+m6M8He40MMzTgoL3ZiiBzUHDsm1YJsMUtCHfmvU813oMiCJ/4Y4WgKcszUP2sFC1zuijA6qlJT5ULHhGq2ogsHT6+uQNztva8UxWba66rrT10fnkMsazhtKkIxOPeTB99kmP5HOgWVuUjChCzMWK0qWtLOltUWTe3u/VoUKNm/D1Yu9U9rglQ8jWwSxGMp9r5Uxqu7XqTt8CYcFkEqo+ByWPEFFNbWV/Oa5cHV2FR4WgQmw2yd6Gl7v7WIuTmZQDBJPLFMy+5KtjWWcGRfAZKRQVWt+OYkYvYyPtm1EOHCF+8FH3iR366vRQuEppsb3SPyuqr9XQNLUjaR5nr3FOGFBT74ZoBRv5m47iSvZBXfn3DP1E5d2TP43Y3Hsm4gH9/8AlmbHWMp9XBnafbOtj01lSa7rdQbynDrxgQR3DQ0VvB6UwFndgban5q82eqZiD6QRscR2SwKgGToaLKKP5Tu3Gib7Fxd4Ws5+Upd82JuwypTNqMXJANeOTxwCd9i91g4jaSawTAA+B9saZuyCHkkigAAAABJRU5ErkJggnic4/ZIzSmINzTTK8hLZxgFIw7wceOXd9V7kMTIAAAhOQWdbDOZ9gEAAAACAAAAIwAAAA4LAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-Advanced_Disabled_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQ4y43Tz4tNcRgG8M+dOTGuRLhF9hi/h81IKRuR1IhSxIIssPAn3J1mb2oSNso0O2oWiIwNu2FWw21YkEm6ykwmv5XNc+rQnfLW6Zy+z/d9zvO+z/vWms2mBeIcjuMrhnC/06Wi8r0Ku/EIX9DACixHbwgW4wieo1UlWIsLOIWbmEA/fuI3NmMv9uEknmAQrZKgL8mvcAjH8A2LgveHYB5vQvSgSvAUI9iPOdQwhcngO7Ap2MqoHKuWMIu7+XMX7uAGZoKvw1kMoAfP8LkkOJAaN+I7XmAY7UqDZ3K2IUrOpLEfC1zEGvyI9Ml/kstoB9seh47iU4F6Erv8X9TiTjdqBUaxOjPQk4Y1OqhoBPuFt5mF+QLXcmEAl1Pb+QWa2BsFj3G96sIy7MzYzoVsfQcbZ7EUu3AP70qCwziN6fhcx7YkSs319KmNgyG/WhJMYBx7cCujeiIquvEeV+LApezLw2oJrcx2H25nHrZiC5akaeN5XuNl3n9tY6vcsMQUPqTm6cr5WNWaPzh+YcvU7DU1AAAAAElFTkSuQmCCeJyTcEwpS8xLTk2Jd8ksTkzKSU2JNzTTK8hLZxgFIwHcYsQv/83N8xQjAwDQFQwKK84VaAEAAAACAAAAMAAAANoBAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-AuthorEncoded-Network_80.png]
lines=4
0=iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDEgNzkuYzAyMDRiMiwgMjAyMy8wMi8wOS0wNjoyNjoxNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI0LjQgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOS0wNS0wOFQyMToxNDoyOS0wNTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjQtMDEtMDVUMTk6NDQ6MTUtMDY6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMDEtMDVUMTk6NDQ6MTUtMDY6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmZkZDc4Njk0LTUxYjctZmE0MS1hMjEwLTAxMDk5ZDMxNzgwZCIgeG1wTU06RG9jdW1lbnRJRD0i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
1=0EmjufoPSrf/HZLy9c/Z/tiY0BhfY4QmmKGcn2oXG2uC0mw9u4vDpHNvsihgXURIdXewf4a3kJpWEXlZeYIMHoELPuY9b7CC8kW9A0VyuszWWxqnVGaw5GhUxdMs1zH7/tS//w0OqmTnWhTjMCOwXRHh+fAMCyLfqeNx1EcW1uPhm88zPxqH7yas75nWs4dCrhiWMO1+yEVjcVEzGITbMSCkWwKmDLVMqFyCEEBAncZWWwrIBWax1gNQzD5SiK8H2f8fHxbwBvrWV42+9+8ZOLV719ZMdLAkZbu2g0GmhHUq7kGPVexai6gMnp0xTsSxCmQJ1NPB73GI4j9rg++zM5Em0R+DGqG0KQIB2JyNrYSYQfQa+TIzq+Faf0UjLPvZcjf381w6Mis/1485/X7Py15WoGFRkQYA+PpCrsui7tdmtjt7uKH4lUApMEHBuMBqPOmYPPjqK3mnDwOFx5KUTxk9bhDIgIkGfm4He2BWECBSck52rqjT7AvOu6QZIk1Go1xsbGvkH8/uBPj/z4I/7f3bTpFUeYcq/CLSQEMQzlHQJhEXkWNWsXJes8ArOfoopoy8tYyE5iiQ5j+JRljoYy6DABS0BGYgJxduFSaJyMIqooJjeGjHYv5qPvrxC7Pt1Ty9fsuHnPT+/9z8/5UGdxFYTEPnni+FkVLpcLOzrdgFrNZdOlQ8webMJwBkySgoYB1JPTUtBL2H8swevbJAkk+knghHwSQHHO1bWh0QM/FNhS0+l0UUrNnxvKfP1m5KETnvM3n/vse4d+7qtk3SpeL0AqH5PRhMqiKopMTh0myt2JrR0c4bLq7GQoSbjQxKwWyjQMOKHBKI2wBEaKJ1845sk9hTFoP09pxyl2blpgdPIyVjt1xi8Y5vSjc+/cfnr1lsJ4IYp6ITKbzZHN5sjl8uTz7pbZ+Q5hYHj+vvHU+cZqoLpnZgJ6IIlCgUk4cjJmtQlKQRhCEEEYQRA++dkfzCCCMIaWB1EUggro9TyA+bPRgDGUHOspAH74r/b/tFd9sJJMzKEaOSLVoxWGzDQ1J9qaqXyWYq5PRt7HnC7ziPV85txJ2rkSWBJXa2KliZTGaINSkGiN0hptDBqDGdh7aScIpbnvb2/g47eez+g2j9/89KO86M2zTD7/4eLi3F0/Fazk8Fs+drlcAQyWbVMums2zsy2WV0Ke+9wCIxuzrJ0OoZZJATtrD88AGIO0OTUfM7eUZdOUwA8HEnhmj37uzzK1kcrAegcEERDj9ftIKZcBbCkQwD8cWsQUqriWpuvH3P3QE28+r7CRdm+I2PRoeiH+UhYSh+q44IDskI36aOt1PJ57HgUbNhuDDQgjqGtNIxH0Y0MQqTTzkxiMMkhlkAq0MihtMFqQqbVZfWgzj95a4+ff9wV2jmRoXvMEN1+7wgP/VnzT6tGXvL8wYWMPjQwjhUgjf726odEA3zc4tuKibTnuOr4Eyk7BU2dkxEpjQqPATlhZ05yc14yPWPjBQCWsp9pBcQ6I2kDTg4mswaiYIAiwLGsmBVAiBHzswVmWTINKxcI7Vr84qrcvdqZtHOHghx16QQPh5ci6OXrC0PObtPov5fby85F5cGPNshR0hCHWhnUFndgQBAoTxUSRIok1ItFIpbGUxiiDVqCVRieCwNNcfNMMG3ce5/jcMFG7gLBrjG1fuKS+cuICt7PhiO33+wghMAYr5+qtnqcBi/VGn00bilhViep7kAdMDCoAKwQdgpUF46JaPidOweU7ivT7AoNASJGCJsWTIA4cSeJCv2vIFRISpVFKIYSYA3CEpoVLZBQl3SEnc3TrjR+KWxF6YxfP7eAuS8ZOvAy3moPhZRwOUlj6GWbyb0dlNLVWSN21aNsSW0BsoB+DjhMKUYIdJ3iRIgoTrEhjJwYSjUkMOlGoxKATDVoRrhVZr2us/iLNoA5WkfJUwKJ79IfCtY1HbGMMlmXhed54HHYn6+sBggxraz0yWYeNGwqcPtCFfH5gYBXoaCBaOk3/+AGnZ13aLRs/BG0EQthwdpsmByGMQEoILPBbkJk2hHGMUgop5aJBk1GGtt6GXaowbHk4uRwrnfDqMAzJdm3CbJvRxd2UvvA2+udnyGzLMWH/C6HzIuo5l1pvjU5iE7oWji3PpmpCZXBijasSVKiI/YQ4UJgolUITG0ysUUmqynFo0MphZMcTSL1Es1NA2i6Wo9G5CKu2fG2yprGHR0bIZrM01lY3nTp5Uq6sRDhukW4nQFgJk+N5Th/vQByCK1MdNAkYe2AHLTCapeWQ1UaClIJYCaQApEAICyEMQmiEkEgrdc2ep3BtQ98PiaKoJSwx6+gcGUsyI+9m8cHLaCUtrKygv96+wBIWgWiRFYLywX00u6sEPQvZuJzy2sWIkQWi9hb6SUwSaRzXwrXTF2iARBl0pOgmiiRQ9HsxOlCISCMChYw0xBodaXRsiHqC2O2x/dIlCtphwbQxkQuFmFAm6Nz6Dm9pHvvYkSNpOl7qzY1GQL0eUaxadLsRcRKQz2Uo1By8RgC2AwMAUNE5MYqhvt5nZS2kXHSIYlLApByAJweqrAcAu0Rhj3wmpO/HREm0mBOlfjXawJ1b/ozHx/4ZR70N6b6eKNqfDe/vjWtt0NkIy8vinN6I5du4gcDhEL1ekchMoyst/MSQ+BaWK7FsmWaHAKMMKlGoyGDCJAUtVGhfoQKVghkYVGRQoSZoCZxii6GxPlFQoVaustr3WO3VaceG9fbiRPfo4xm7VC6TyWTw++tbm82Enm9TrCq6PUMUJbhZQ63i4jW6qd1DpiCKGPQZ46Zpt0OWVwKkgCAaqK2QCKkHamwhpMCSgrZnYYmIStEwt9TDjYpLNTHNXRvfwx1T/0whhsILPsjFrZdgHnmd+2n19pLvNCg+cTHWqWM0dt6GzRrOdge3cTOMHMXVAX5zGy3PJpePyLgCMQDwbLZEaXSiEaFGhAoRKLSfgK+QvsIEGhVpwr4ijgw6kSyvuWS3JKiwQsdvcnq1QVRxCKNOLu5FeTuby5HL5VBJa3O7ExOEhiTR9HoJcazwvAjHtpAZiVbRwAMLkKT2T6cS2Pd8VlZ9igU5CGXsc+zeGVUWWLZkeRW2TATkchrtuSgrPPQv236NJ0YfoByBqyFYb3AouolhfYsUZhJh1wm8LkOfeAX9V36e4FV/xuYvvot2e4iwtIOxLY+CEZTEEEkvR48sGTdEWqlXF2YQiSUaGWtkqDChwgQxxleoQGMiRewlhL0EQ0xvtszhxypYE3eyctyimYR0oph2JIl8YTA6zcY4tk2vPbNpadmj3YyYnFAEcUycGJIkASFxMxB4CmQ4AG0gfUSARoWGtbU+wzWbMAIhEoS0zkqeEAopBZYtWFtXXLQpImMLMmGNB6Y+/Ob7Jx9486QHlk6/3kkgrsXM7Xkd/MN/QcY1dKlN+3ie8t/8KO6bE5o7bid7YBuqNUL91D6sXJsLdzxCr7+ZoDdCkskgpEGKNLaUBkRiINbpBiFMMIFGRwkm1Cgvwe8mRF5C4iuytiTILnHvyhzR+hQEhjm3hyj1sUJwLKHt9bU1HNshjvvnLS76mFDhBxFhmIYYSaLRSqfBmxzEfiYEJQZZHZPuUGJNo9Gn1XKIk9TZpBJoDYCUg1KooNFKsK0EgSaKI7zc2hNC07cH4J0ZUkPso7Vo75bWUEZrCzPUwffzFD/+4wRveC/u2H78hRtJjIfuuzzytZ1kcwG5bJeon1ocIwUCgTAGqQ0i0YhIQawxkcbEisRPCDsxYU8R+wqlYmzLJzh4OctbvkTgdtFyHbO2hQ1LL6LV7TQjE/bsMAjwkl7R7zanj55UQMxqw8e1JXGckCQpiErp9IkYbLxNkIInDQgbtKbT6dFqOihjARbCsgYgnrGHFo4l6XQMtvCJlaCr17ix/raXB+XfPL2YW2YoTMMObUOxCNXHPkYryX6hm/nsTcQZLGGjS22i2QnK9/4ITsaFtiGSNnbWwpYSY8bxyi0sJ8B2UxMiRQqg0AaZGIQyqU2MUsDiXip5cT8hSWKkpdGFVTpf3EtF/jTJi/+IwtIU9p0/htQ7kENfPR21Q2Wfv2MHK8tL04+d6pWGhy0K
2=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
3=8120uLizON5vqp1dW1w/v3HzyptJmdnJyem5ufVxdeeBFTU1N86UtfYnR0FNd1KZfLrKysEMcxMzMzPPDAA2eW6QLlwbwk40w/tzK55Rp3XO4oTJZHJyf2MpS9DJIcfhhBXmHXDIHfpttcWlqbOXRi+eBXH+stHH8UWEvJkETngNUdzN5gRmde9LMC0BjD+vo6SZKwa9euH5mamvrhYrF4lW3bF4BgYqzI3Q/M8rf/JCmURsllHaR00zzhoLRpWYJcVlApu+w4L88l51sMVRwyrgQTYRIPo/pKEM33u82FtdX6qZ7Xnz09M3csjNR8o9k+HYTxwn33398XwL59+7jjjju48847z12uO7BVOWAMxFab2nbHKU3jWCNaCjV6rXmFWzXVhVv7fxV2V1dBrwD1ASgMpKw7MCm9wdUfqG389Tb6WbU5GGMoFApEaUPNpzzP+9SJEydot9vbxsbGt9au3/WCVlf8lzC2yOsQpRS2ZbBtjbRspJ1BShcjsiw1MmA7bN4E9BSNto/vxyRKgbEtKcXmfHZqcyY/cV0uF7JneieoPtIEJFGv/rKbrlkIE3nqkSeOH967d+/v9Xpd/+GHHzmz1Ggwm8ASmIMJDSeJGy7ptnW9sItHKhdSPfmP/N7ApuWfLHAPuCbpNTlnfvd9Imf4zJZlkclkSJKEYrF44hWvePmJoaFS5gMf+wxxMowxmkQZiBVGWNgirfYj4pSpYBRB4KITh+GyIes6KJ0h1pIwFvQjQ6+fUG9HBH5IGAVYODhWkYwzPCakHLvm8vHdwnL44EMP/uGLX3Qz8/ML1Ov1p9tFnQHlbPQ7fg1+7TLOkpm+666Cb7cBJggCer0eGzZs4IYbbmBoaIh2c/Ylqw0NwkLpNF2e8p00Go1lpVlrnSgSI+n0FMtrFuMjgjjW+JFC65SVZWMoZ6GQEahyDkQBg0WQCPwYvnaij2aJ7Nqpu+JE9TK5PNddfz3/9OlPf8v1X/I2GLk6DZau+RDc99PfAwCVUs94g5SSMAzpdDp4nsemTZu49tprmJ5+kkG/Uu9eGGuXStkmGtDh5AA+ZTSOq5EyhTRKNFGiWFnT9PyUehEnECUabUBrgzIpkwADlkxQg5A6Z0uG8wGTVc3M6eCYm8my3mhw6WU7uf+++1haWvrm4P0aXPZfoXMYoQLY8qOpjN73M98lgOeEA087lFIUCgUmJiaYnJzkla98JeVy+WxHkZSSpbp3YWIcxkYzLCx0CbGw0Ugz4N/pBMtJ2Qlaa4I4YWHVotWxyeVSANNp0AYSpVMOmBQkChIDBkNiLKJYYak+7V5wNJ8vIoSFtG1e+rJX8uEPfuhpTdYlvwaX/TfoHAEVpuyU1n7Y8tr0798NiPbP/dzPPeMNSZJQKpU40w5xxh6e09O2eWHFm/ZDh6lJh5VVSd9Pa8nCpMWkRGssrbBsiUaRJILVZsJKQzAxIgljUBqi2KQcFgPSSqVQmVS1jQAvTvntUns0Wt5R23Ex0tBe8zh/6Cr2vPBuHn34CcobwV+BYAUufssAvMNPgnfGQp4FUXzn6mxPTk5+l82AyYVL9Qg/dHEcQz4nabcjhJRILZFWAlIglcQ2EqRAaUW7a7Ha0OSzKZvLYEgUhJFJC/E6JWJqUkAN0PAg7xpM0qXrRUdyhTx2ksWJS5y4+F/Z8JMnqaxAaRqCOvQXYPjKpwHvnJ7O1v6BOvOdgWh/N/1uKZDeBStrMbHKEcWKfM5CCEUURtgOCKUH/BiVSqKt0crG60OjLahVbAxp3VYZQaIERhiMEAPqLQP6Lax3FBMTBhP7rV4YzIzIGpn2CKee99fMXnsfeQ+KYxC1wanA8CSEa6CTrwPvewii/Sw7I592WJZF0OtfvLQWY4yg58VIS+K4gm4vwSARVkptQyiEUlhJjDI2cWzTaBrGR7JoDUJILEtgBMTqDGc5BfGMm2u2IsqbE8LQO2H3Kl7GLbK09/MsXnEf2VbKd4oGypH00nmmY+BbtWefBfHbdCz2mf3sdzrq694Fy2sKIQyeFyOkxHUsEpVgYoWlB31wUiEQJDLNPSdK02pbdDoWQoIyaQ5OCkGoUvU1iDS8EWCMhdcNyLs+6tTofeQeY//L/5j21BxuH6wYzLNrMw6fEcRv07F8tw3XYmHZu6DegKFhQ9ePkVIirLQDPIoSbFsOiJZPJqyEFCTK0O4mtHsKxxUkCQShwclYJCqVwlQC01J3rCyMihnSWR7NP+ocffUHrmZDu5Ntc1hodhpBZhAwHwAuGWzpAB4Z7JG3ncnPDrZlzyiJwoKHfhHi7rNQYa0N9qB16dnaxIEj2T631J9sdiXlqsLrg2DAkRYQJwptkpRwfqaXZUDsUsai249pdWPyeYskBiM07sCJRMmTUmiMoBMY8pahKA1f2/H+n+0V2z871mDJSKYQPHpOjs4GHjsnb7cBeDXw5+cs/9FnUufmftj4SqhcDPf+BHSOfgsnEgQRjmNj2/JsiurZAal2zCz26fQhjBRxnDapiEHPcJJolE6QalAyOtM6JgzKaDxP0OnFKWEkTgGzQ43tWmebdswA8Xoz4dJpjWsH+LPVP3AvZs5IFgYLeT1QGmRSAF47yCADNIDPnZMseBuw5ZlsogDaByG/CV74BXj4LTDziWdQYcuSJEmC7yfkchkyGfdZnlsQ7Dg518cPSdsHTMreEgziNw1aqQFbf8DiOgugwQ8EXS/dI8cJKJVyNpxM6oWTZAAggpWG4XmXJmi7EUzf9TO/qXPvZmnLEQpprvajX7ewr3/cY4N5Btwt3+owAWFDfxayE3Dlu6FyCTzx+6lHf1obeCaz3O/7NBpNyuUyhULumc82iL2Ljs8GRImFH6gnO9RJA7dEiRQUoUGYQeuXRBuJ0QkGQ6frIGR6r05AC4EVGIQjUTp1IiBotBSTNYFnWqeS2ObCB95Cr/wr9Gpd8r1v65yI3LM28HYajNt5uPhX03308Q/D7Ke+iRORUuC6No1Gi9nZZcbGhpmeHsd1n/7sgoUl76KHD/Sh59L10t4Q9KDF36ROQFg2luVgDRwLA7aoNgJlNB0vSkmQWqQtBsiUq+JYqQMxgkRLgsBnrOrQ65rjSWkdW2zmmi+/hxOXfIzZbbeS8f+dThCx0taY5uNQvhCufh+c90ZYfxD8pafxwsaA6zpIKVhaqhMEEVNTY1Qqxa+/tRrE1hWjU9MEymWlGYKfljSsrCaXl7iOjWtJhJ122FhSpDsUxwYhUy8rBaFOdyEq1uhEoUUClj3wwuCFNo4IGS0J5majI66TJ851yHvTbDvwepambyXMQtZ/1qHMt30qjbBSaURA5SIYvgqk/U3CmDOt98ViHqUUc3PLtNsFisU8R48eZHl5kWp1aPtdd92Zf+11ebQ1xXwzy2ozT7M3zHIny1rT0OhE0E6DtEw+IZ+zcJyUtyOlhWVbCGUIPUVkBCYxmGRw6JAj0Ei0Mqx3YMeUplZUPNKKjmRyGSzpEpTq5PxJdhx9I4/t/huUNeAE/Tsf7xOupfNbxoEpZyYtHnU6Hu12j3q9w+c//xX+5V8+9ZBSyVWbpmqv3TBd/ZGtmzds3To1inSG6UYVOkGVpj/Eul+j0a+y2slT70ianRAiH5wEK6vJ5gyWbaVgxQoTKzAC4SrcQoasI4iNYfsmm7ybsN4Ojjm2kyYrMETZJptP/ATt8lGO77iXUjftwv13kcTvJpCWMj1N44YbnsPznvcCtmzZwf79jz+0vl5/aGmt8ZbF1cUrHWflxbal95Xz8srhWnZkslrivFqVaKiKlwzRVuN0olHa4SjL/REa/TLrXQXtIDU0xgehkLbASgQiSRAI6EvOm7IRxtdekJwo5twnxcFSxIUWlx/870j5DhYm70KYOI2YfpAAzOdzSFlkcXFx78zs3E+NjIxeeNVV1yWNxrpptxvrzWbjRKvVaPR63Qe6gV726uKS+dX+ljhaH844yHLRopSX1PJZZLZImB0lGtlEnylaegrPTNDsj7DcEDTWQ3THI/YiPDeBjmLrWJkgNrOxEvPCeuqBFEnWR4YZLn/id+nlf5L1oeNkw/9gAM8E0vl8nlwuy/Jy/cWzs4u/cOzokZc+
4=/vijIATVag2tE5SKqZQL1GrVdNfQ6eD1vFajUbfWGo2UIuY4OK6LY/tI0cAWx8jaXzHFgis2VGpkCmNQnCSoTBFsnqYvpmmLaZa9KqvzCVdc4hDquRO1aoXRkdo3xC1SO9hJlnzJoZ58/46p+qZOJJ/Pk8/naDRaLz89M/erR48efe7pk8dZWpyj3W0DEstyyOZyhEFIpVqmWqlSKOQZHa0yMT5cnZoeY6oxwfr6Go1GA9/36LQ7CAGlUsWEKh+0Q9M+udRYj8M56dpqqlpyKsPDRcbKQ2zMjXFRborwgimi1tX82313du687SsEYfgUMmZ6PkaawC3/0ixDL4Rg5ltkYb5XfiVJEqIofWVhGJHPZ2g0WjzyyIFXnT499ytLS8s3LMyfxvc7tJpNtBHk8nnCMMSynJRe0e6SyxUwGFzXRQDj46OUy0UyrpO20VsSjKHT7dButfD6IVGUGKWSXr/vne5224e9XuvxIPAWDDKby+WusqW50LXijaWitSFTnGJhcfUNJ0+e/sgzPVDpErjxnyFsp125TzPuB67mOz7w7mkAjGOF69gEQUQQhi9fW2u85dixE8+5/4EHOHn8EHOzJ4nChOGRMYS0wEC316NUrpAkCoTADyJsO/0O3w+R0iaIAgr5PBnXYXh4iELepVat4DoWcRIP9suKfj+k1+2y3u42Gwuzty8vnf5kvd25FWgKIcZKpdKOKIqsIAjuADKDpME3VdTrPwJj16Vp/X93AI0xaK3ptL3XLq+s/WK/H1xjWRajo0PEUcj8whyNxjpHjx5hYX6eo0eO0e50ieOYbK6AMWA7DnGckMnm8Lw+tu0SRzHCSvl2Xq+P0pogCCkWCji2oFypUCq4lMsFclkX02/TKGykXrsUa/YA6vgd7ZnlxVvm5mb+elDDtQZEnwawOCiAP+247hYYvwH85e8PgK9+/PGjv9VotC/LZDKUSvnBTkSSzWaoVCrk8xmMgWazwcLCPKura8zMzHDwwEEWF5dYWq7T7npYMjWpjpshimNKpTKJUiRxQhwPCk3CptvtkCQG3++TzWYoF7JkXQdjWeQ3X4ClE7xTj1Cs1lhfX53f//jX/kwp7Q/SVI8OqBZPO8o74Hn/DIk/6M79dwbQPnDwxA+Njo5ftm3b+bRbTbq9Lkql5UpjNJ7Xxfc9bNuiUqkwOjoEwBe/+CUajVW2nreZJEnodj1W1xosLK6wsLBCp90lCGLcTAbLkkRRiJvJp+cC2jauK3BdC8ty6PsB9XWfrCu4tHSEbq9FPwE3ConC/gZjuBb4g2+axztn7HgTZEYhPPJ9ciLnnbctd/nll//ui1/80lfvueKqLdvP30G1miOOwfN6xHGElIJcLodlCe6//z4+//nPMzc3i+tmKBYLlMsVSqUC2UwWYdksLi7TanVZWVnl8JHj9L20pSGTL6G0IZvJIC2JMYYoiOj3YyYna4wO2aytr6OUYGSkxszp4xw7duzBQb7v6Ld6mPIOuPG2dM+qv6mCf49V+JyfC9ls7rorr7z6hfv23fCCa6/dd9WuXbvZtOnJI5iWFhfiRx971DQaTSeOE9FqtVheXqbVatLv+/T7fTrtJlfv3cubfuGXsWyXhx97gsOHDnPgiQMcPXyUpfklev0AjEOkDJlsjo3TNUp5Q311lUplmGq1wBP7H+XUqdN/DvwK3+oYycG48p1w3hugfTjd/H+/Afz6cdmmTec9/5prr7vpOTc89/qrr76mduFFF1AqOgAqDAPv1KlTYnZ2LrO6uurOzs6wuLjIVVft5WWveCXZYhkvUDhZC2Wg3QlYWlzg9KmTHDl4iCMHDjF7apZK3qa1Ps96x2fnrt0IE3HvvXfNLy6t/H/Avz7bBylfADd+cSB9zxxIf98APHdMuG7uOXuu3Hvj8577gudfv+/67VfsvoLJySqAnyRJ58SJ41a1WhseHx8XkYbV9Q6x0gSJIkoUSkmE62Jl8mig0VijtbZKu92i11gjXpvjti9+ji9/5Y6P9n3/Fwbe9lmPK/8czns9tA89o/T9hwF47nCBa7duveCmG2543o379j3nil27djnbtm9jqJY5e1Pbj2l1+vhRTJScIRUlg6vGTzT52gSTkzkW9x/mf77rdxp///GP/TJwy7e7oGdp+35gAPz6cVGpPPyCPXuuftHeq6/du2/fvvE9V+5hciIlIPU01Nf7NNs9/DDCjxK0dBifmkJ3W3zm7z7Ie9/1R/9UbzV+AZj7ThZw1bth649B+9l53v3ApT9IAJ47RoB95229+MZrrr3++ftueM7FV1x1NVu2nUeuZLPaCglihWM7PH7vPXzgXe9offHLn/814IPf6T8sXwgv+CxEjWclfQAPAlf+oAL4lAQJsLdcGnnh7t17bnzhTTdf+8Ovea1brlR53zv/B+/603d8OEz83wFmv5t/MnYDXP9R8BefdWFpw2A7eOIHHcBviHHHx6ZvLFeqY8eOHfgycMf34kuHr4J9H0sl0Ci+7+P7eZb+0ZX6QnulvlADDvN/yPjfCFsKNOegSE4AAAAASUVORK5CYIJ4nOPzSy0pzy/Kjrcw0CvIS2cYBSMLpJvjl5/on1nJyAAAJiAHlAjAE2kBAAAAAgAAACYAAABnNwAAAAAAAAEAAAAAAAAAAAAAAA
