[License]
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// This script is part of the PhoenixPE project and distributed under the MIT License.
//
// Additional 3rd party tools, encoded files, and programs used by the project are the property
// of their respective authors and may be subject to their own license agreement.
//
// Copyright (c) 2014-2025 Jonathan Holmgren (Homes32)
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////

[Main]
Title=StartAllBack
Description=A full featured Start Menu replacement for Win11 that allows you to replicate taskbar and start menu behavior from Win7/Win10.
Author=Homes32
Level=3
Selected=True
Mandatory=False
Version=1.2.2.0
Date=2025-06-21

[Variables]
%ProgramFolder%=StartAllBack
%SetupExe%=StartAllBack_setup.exe
%DownloadURL%=https://www.startallback.com/download.php

[Process]
Echo,"Configuring [ StartAllBack ] as the start menu..."

If,%SourceVer%,Smaller,10.0.22621.0,Halt,"StartAllBack is intended for use with Windows 11 sources. For Windows 10 sources please enable the StartIsBack++ script instead."

RunFromRam

If,%cb_AlwaysDownload%,Equal,True,DirDeleteEx,"%ProgramsCache%\%ProgramFolder%"

Echo,"Extracting files..."
If,Not,ExistFile,"%ProgramsCache%\%ProgramFolder%\%SetupExe%",Run,%ScriptFile%,DownloadProgram
7z,"x -r -y #$q%ProgramsCache%\%ProgramFolder%\%SetupExe%#$q * -xr!UpdateCheck.exe -o#$q%TargetPrograms%\%ProgramFolder%#$q"
If,Not,#r,Equal,0,Halt,"ERROR: Failed to extract [%SetupExe%]. The error code returned was [#r]."

FileVersion,"%TargetPrograms%\%ProgramFolder%\StartAllBackX64.dll",%ExeVer%
Echo,"StartAllBack v%ExeVer%"

If,%SourceArch%,Equal,x64,Begin
  Set,%COMDLL%,"StartAllBackX64.dll"
  Set,%LoaderDLL%,"StartAllBackLoaderX64.dll"
  FileDeleteEx,"%TargetPrograms%\%ProgramFolder%\StartAllBackA64.dll"
  FileDeleteEx,"%TargetPrograms%\%ProgramFolder%\StartAllBackLoaderA64.dll"
End
Else,If,%SourceArch%,Equal,ARM64,Begin
  Set,%COMDLL%,"StartAllBackA64.dll"
  Set,%LoaderDLL%,"StartAllBackLoaderA64.dll"
  FileDeleteEx,"%TargetPrograms%\%ProgramFolder%\StartAllBackX64.dll"
  FileDeleteEx,"%TargetPrograms%\%ProgramFolder%\StartAllBackLoaderX64.dll"
End
Else,Halt,"StartAllBack ERROR: Unsupported processor architecture. StartAllBack does not support [%SourceArch%] sources."

Echo,"Extracting required files..."
// shdocvw.dll needed to display the user account pic
RequireFile,\Windows\System32\shdocvw.dll

Run,%ScriptFile%,RegisterSAB
Run,%ScriptFile%,Config

[#Config#]
// ===============================================================================================================================
// Name...........: Config
// Description....: Configure StartAllBack.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: [Process]
// ===============================================================================================================================
[Config]
Echo,"Configuring the Start Menu..."

RegHiveLoad,Tmp_Default,%RegDefault%

///////////////////////////////////////////////////////////////////////////////////
// Adjust some Windows taskbar settings

// Align icons (0 - Left, 1 - Center)
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarAl",0
// Remove Chat icon from taskbar
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarMn",0
// Remove search from taskbar
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Search","SearchboxTaskbarMode",0
// Remove Task View 
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","ShowTaskViewButton",0
// Remove Widgets from taskbar - Ignore errors as UCPD blocks attempts to modify this key as of the ?Aug 2024 Cumulative update?. Pretty sloppy pattern matching on behalf of M$ to block this in an offline/user mounted hive.
System,ErrorOff,1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarDa",0

///////////////////////////////////////////////////////////////////////////////////
// Config Defaults

RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","AutoUpdates",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","SettingsVersion",5
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","WelcomeShown",3
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","IdealHeight.9",196614
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","IdealHeight.6",1
RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack\Cache","IdealWidth.9","Control Panel"

RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","StartMenuFavorites",2
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","StartMetroAppsFolder",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_AdminToolsRoot",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_NotifyNewApps",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_RightPaneIcons",2
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowCommandPrompt",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowControlPanel",1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowDownloads",1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowMyComputer",1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowMyDocs",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowMyMusic",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowMyPics",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowNetConn",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowNetPlaces",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowNetPlaces",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowPCSettings",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowPrinters",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowRecentDocs",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowRun",1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowSetProgramAccessAndDefaults",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowSkyDrive",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowTerminal",0
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowUser",1
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_ShowVideos",0

///////////////////////////////////////////////////////////////////////////////////
// User Defined StartAllBack Options

// Theme (Decoupled from Style/Orb)
If,%cmb_Theme%,Equal,"Proper 11",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FrameStyle",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","ModernIconsColorized",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","SysTrayStyle",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",30
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",36
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","ShowStatusBar",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","BottomDetails",0
End
Else,If,%cmb_Theme%,Equal,"Kinda 10",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FrameStyle",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","ModernIconsColorized",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","SysTrayStyle",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",30
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",36
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","ShowStatusBar",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","BottomDetails",0
End
Else,If,%cmb_Theme%,Equal,"Remastered 7",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FrameStyle",2
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","ModernIconsColorized",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","SysTrayStyle",2
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",54
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",54
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","ShowStatusBar",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","BottomDetails",1
End
Else,Halt,"INTERNAL LOGIC ERROR: No configuration defined for theme [%cmb_Theme%]"

// Start Menu Style
If,Not,%cmb_StartMenuStyle%,Equal,"Default",Begin
  RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","AlterStyle","%PEPrograms%\%ProgramFolder%\Styles\%cmb_StartMenuStyle%.msstyles"
  RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","TaskbarStyle","%PEPrograms%\%ProgramFolder%\Styles\%cmb_StartMenuStyle%.msstyles"
End

// Icon size
If,%cmb_StartMenuIconSize%,Equal,"S",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeMFUIcons",0
Else,If,%cmb_StartMenuIconSize%,Equal,"M",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeMFUIcons",2
Else,If,%cmb_StartMenuIconSize%,Equal,"L",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeMFUIcons",1
Else,Halt,"INTERNAL LOGIC ERROR: [%cmb_StartMenuIconSize%] is not a valid Start Menu icon size."

// Orb Bitmap
If,%cmb_Orb%,Equal,"Default",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","OrbBitmap",""
Else,If,%cmb_Orb%,Equal,"Clover",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","OrbBitmap","%PEPrograms%\%ProgramFolder%\Orbs\clover.svg"
Else,If,%cmb_Orb%,Equal,"Win8",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","OrbBitmap","%PEPrograms%\%ProgramFolder%\Orbs\w8logo.svg"
Else,If,%cmb_Orb%,Equal,"Win7",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","OrbBitmap","%PEPrograms%\%ProgramFolder%\Orbs\Windows 7.orb"
Else,If,%cmb_Orb%,Equal,"E1even",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","OrbBitmap","%PEPrograms%\%ProgramFolder%\Orbs\e1evenorb-pr.png"
Else,Halt,"INTERNAL LOGIC ERROR: No configuration defined for Orb Bitmap [%cmb_Orb%]"

// User Account Picture
If,%cb_ShowUserPic%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","HideUserFrame",0
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","HideUserFrame",1

// Transparency
If,%cb_MakeOpaque%,Equal,True,Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","StartMenuAlpha",255
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","StartMenuBlur",2
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","StartMenuColor",-1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarAlpha",255
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarBlur",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarColor",-1
End

// Large menu icons
If,%cb_UseLargeIcons%,Equal,False,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeAllAppsIcons",0
Else,Begin
  If,%cmb_StartMenuLargeAllAppsIcons%,Equal,"M",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeAllAppsIcons",2
  Else,If,%cmb_StartMenuLargeAllAppsIcons%,Equal,"L",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_LargeAllAppsIcons",1
  Else,Halt,"INTERNAL LOGIC ERROR: [%cmb_StartMenuLargeAllAppsIcons%] is not a valid All Apps icon size."
End

// Sort items by name
If,%cb_SortByName%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_SortByName",1
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_SortByName",0

// Display folders before items
If,%cb_SortFoldersFirst%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_SortFoldersFirst",1
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_SortFoldersFirst",0

// Fly-out menu (Windows XP style)
If,%cb_FlyoutMenu%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","AllProgramsFlyout",1
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","AllProgramsFlyout",0

// Show search in menu
If,%cb_ShowSearch%,Equal,True,Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","Start_SearchPrograms",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","Start_SearchFiles",2
End
Else,Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","Start_SearchPrograms",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","Start_SearchFiles",0
End

// Number of recent programs to display
RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","Start_MinMFU",%nb_MaxRecentPgm%

// Taskbar Settings

// Visual Style
If,%cmb_TaskbarVisualStyle%,Equal,"Default",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","TaskbarStyle",""
Else,If,%cmb_TaskbarVisualStyle%,Equal,"Plain8",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","TaskbarStyle","Plain8.msstyles"
Else,If,%cmb_TaskbarVisualStyle%,Equal,"Windows 7",RegWrite,HKLM,REG_SZ,"Tmp_Default\Software\StartIsBack","TaskbarStyle","Windows 7.msstyles"
Else,Halt,"Logic Error: [%cmb_TaskbarVisualStyle%] is not a valid taskbar visual style."

// Icon Size & Margins (Experimental)
If,%cmb_TaskbarIconSize%,Equal,"S",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarLargerIcons",0
  If,%cmb_TaskbarIconMargins%,Equal,"XS",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",1
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967294
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",38
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",28
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"S",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",1
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967295
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",38
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",32
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"M",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",0
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",38
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",36
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"L",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",1
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",38
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",40
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"XL",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",2
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",38
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",44
  End
  Else,Halt,"Logic Error: [%cmb_TaskbarIconMargins%] is not a valid taskbar margin size."
End
Else,If,%cmb_TaskbarIconSize%,Equal,"M",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarLargerIcons",0
  If,%cmb_TaskbarIconMargins%,Equal,"XS",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",1
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967294
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",48
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",40
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"S",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",1
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967295
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",48
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",44
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"M",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",0
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",48
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",48
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"L",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",1
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",48
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",52
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"XL",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",2
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",48
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",56
  End
  Else,Halt,"Logic Error: [%cmb_TaskbarIconMargins%] is not a valid taskbar margin size."
End
Else,If,%cmb_TaskbarIconSize%,Equal,"L",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarLargerIcons",1
  If,%cmb_TaskbarIconMargins%,Equal,"XS",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967294
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",56
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",48
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"S",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967295
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",56
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",52
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"M",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",0
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",56
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",56
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"L",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",1
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",56
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",60
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"XL",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",2
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",56
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",64
  End
  Else,Halt,"Logic Error: [%cmb_TaskbarIconMargins%] is not a valid taskbar margin size."
End
Else,If,%cmb_TaskbarIconSize%,Equal,"XL",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarLargerIcons",2
    If,%cmb_TaskbarIconMargins%,Equal,"XS",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967294
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",80
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",64
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"S",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",4294967295
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",80
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",68
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"M",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",0
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",80
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",72
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"L",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",1
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",80
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",76
  End
  Else,If,%cmb_TaskbarIconMargins%,Equal,"XL",Begin
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarSmallIcons",0
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarSpacierIcons",2
	RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbHeight.96",80
    RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack\Cache","OrbWidth.96",80
  End
  Else,Halt,"Logic Error: [%cmb_TaskbarIconMargins%] is not a valid taskbar margin size."
End
Else,Halt,"Logic Error: [%cmb_TaskbarIconSize%] is not a valid taskbar icon size."

// Taskbar Location
// Note: Since we do not have any documentation for the Settings bitmask we just update the entire thing for the taskbar position at its defaults.
//       It's important to keep this first as we modify individual bits for other setting such as Auto Hide later on in this script.
If,%cmb_TaskbarLocation%,Equal,"Bottom",RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",30 00 00 00 FE FF FF FF 02 00 00 00 03 00 00 00 38 00 00 00 26 00 00 00 00 00 00 00 DA 02 00 00 00 04 00 00 00 03 00 00 60 00 00 00 01 00 00 00
Else,If,%cmb_TaskbarLocation%,Equal,"Top",RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",30 00 00 00 FE FF FF FF 02 00 00 00 01 00 00 00 38 00 00 00 26 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 26 00 00 00 60 00 00 00 01 00 00 00
Else,If,%cmb_TaskbarLocation%,Equal,"Right",RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",30 00 00 00 FE FF FF FF 02 00 00 00 02 00 00 00 38 00 00 00 26 00 00 00 C8 03 00 00 00 00 00 00 00 04 00 00 00 03 00 00 60 00 00 00 01 00 00 00
Else,If,%cmb_TaskbarLocation%,Equal,"Left",RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",30 00 00 00 FE FF FF FF 02 00 00 00 00 00 00 00 38 00 00 00 26 00 00 00 00 00 00 00 00 00 00 00 38 00 00 00 00 03 00 00 60 00 00 00 01 00 00 00
Else,Halt,"Logic Error: [%cmb_TaskbarLocation%] is not a valid taskbar location."

// Taskbar Combine Buttons
If,%cmb_TaskbarCombineButtons%,Equal,"Always, hide labels",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarGlomLevel",0
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarGrouping",1
End
Else,If,%cmb_TaskbarCombineButtons%,Equal,"When taskbar is full",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarGlomLevel",1
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarGrouping",1
End
Else,If,%cmb_TaskbarCombineButtons%,Equal,"Never",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarGlomLevel",2
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarGrouping",1
End
Else,If,%cmb_TaskbarCombineButtons%,Equal,"Never, hide labels",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarGlomLevel",3
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarGrouping",1
End
Else,If,%cmb_TaskbarCombineButtons%,Equal,"Never group",Begin
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced","TaskbarGlomLevel",3
  RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarGrouping",0
End
Else,Halt,"Logic Error: [%cmb_TaskbarCombineButtons%] is not a valid option for combining taskbar buttons."

// Plumpness: 0 - Off, 1 - Buffer, 2 - Aura
If,%cmb_TaskbarPlumpness%,Equal,"None",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FatTaskbar",0
Else,If,%cmb_TaskbarPlumpness%,Equal,"Buffer",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FatTaskbar",1
Else,If,%cmb_TaskbarPlumpness%,Equal,"Aura",RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","FatTaskbar",2
Else,Halt,"Logic Error: [%cmb_TaskbarPlumpness%] is not a valid Plumpness setting."

// Center Taskbar Icons
If,%cb_TaskbarCenterIcons%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarCenterIcons",1
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarCenterIcons",0

// Auto hide taskbar - Bit group 9 bit 1 (0x03 - Hide, 0x02 - Show)
RegRead,HKLM,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",%TaskbazSettings%
If,%cb_TaskbarAutoHide%,Equal,True,BitSet,%TaskbazSettings%,9,0,8
Else,BitClear,%TaskbazSettings%,9,0,8

Set,%NewTaskbazSettings%,#r
RegWrite,HKLM,REG_BINARY,"Tmp_Default\Software\StartIsBack\Taskbaz","Settings",%NewTaskbazSettings%

// Segments (? TaskbarOneSegment)
If,%cb_TaskbarSegments%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarTranslucentEffect",2
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarTranslucentEffect",0

// Dynamic Transparency/Aura/Shyness
If,%cb_TaskbarDynamicTransparency%,Equal,True,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarTranslucentEffect",1
Else,RegWrite,HKLM,REG_DWORD,"Tmp_Default\Software\StartIsBack","TaskbarTranslucentEffect",0

RegHiveUnload,Tmp_Default

[#RegisterSAB#]
// ===============================================================================================================================
// Name...........: RegisterSAB
// Description....: Register StartAllBack COM interfaces, etc.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: [Process]
// ===============================================================================================================================
[RegisterSAB]
Echo,"Registering StartAllBack..."

RegHiveLoad,Tmp_Software,%RegSoftware%

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\AllFilesystemObjects\shellex\ContextMenuHandlers\{a2a9545d-a0c2-42b4-9708-a0b2badd77c9}","","StartIsBack Menu Pin"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\AppUserModelId\StartIsBack.UpdateToast","DisplayName","StartAllBack"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\AppUserModelId\StartIsBack.UpdateToast","IconBackgroundColor",0
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\AppUserModelId\StartIsBack.UpdateToast","ShowInSettings",0
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\AppUserModelId\StartIsBack.UpdateToast","CustomActivator","{da3306b1-2554-420b-8d0e-6bd29bb4d8ed}"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{117E3954-5034-453A-A18B-7B79493646E6}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%LoaderDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{117E3954-5034-453A-A18B-7B79493646E6}\InProcServer32","ThreadingModel","Apartment"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{865e5e76-ad83-4dca-a109-50dc2113ce9b}","","StartIsBack All Programs Folder"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{865e5e76-ad83-4dca-a109-50dc2113ce9b}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{865e5e76-ad83-4dca-a109-50dc2113ce9b}\InProcServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{865e5e76-ad83-4dca-a109-50dc2113ce9b}\ShellFolder","Attributes",672137216

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BA}","","Settings Pages"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BA}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BA}\InProcServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BA}\ShellFolder","Attributes",-1610612736
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BB}","","God Mode"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BB}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BB}\InProcServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{99E2B362-3E4E-4255-9B29-41A7F40777BB}\ShellFolder","Attributes",-1610612736

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{a2a9545d-a0c2-42b4-9708-a0b2badd77c9}","ImplementsVerbs","startpin;startunpin"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{a2a9545d-a0c2-42b4-9708-a0b2badd77c9}\InprocServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{a2a9545d-a0c2-42b4-9708-a0b2badd77c9}\InprocServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{ab0b37ec-56f6-4a0e-a8fd-7a8bf7c2da97}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{ab0b37ec-56f6-4a0e-a8fd-7a8bf7c2da97}\InProcServer32","ThreadingModel","Apartment"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{AD1405D2-30CF-4877-8468-1EE1C52C759F}","","All Apps"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{AD1405D2-30CF-4877-8468-1EE1C52C759F}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{AD1405D2-30CF-4877-8468-1EE1C52C759F}\InProcServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{AD1405D2-30CF-4877-8468-1EE1C52C759F}\ShellFolder","Attributes",-1610612736

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}\InProcServer32","ThreadingModel","Apartment"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}\InProcServer32","","%PEPrograms%\%ProgramFolder%\%COMDLL%"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","","StartAllBack"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","System.Software.TasksFileUrl","Internal"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","System.ControlPanel.EnableInSafeMode",3
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","System.ApplicationName","StartIsBack.Config"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","System.ControlPanel.Category",1
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}\DefaultIcon","","%PEPrograms%\%ProgramFolder%\StartAllBackCfg.exe,0"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}\Shell\Open\Command","","%PEPrograms%\%ProgramFolder%\StartAllBackCfg.exe"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\CLSID\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}\ShellFolder","Attributes",0

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\Drive\shellex\FolderExtensions\{117E3954-5034-453A-A18B-7B79493646E6}","","StartAllBack"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\Drive\shellex\FolderExtensions\{117E3954-5034-453A-A18B-7B79493646E6}","DriveMask",255

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\MSILink\shellex\ContextMenuHandlers\{a2a9545d-a0c2-42b4-9708-a0b2badd77c9}","","Start Menu Pin"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\sib-activate","URL Protocol",""
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\sib-activate\shell\open\command","","#$q%PEPrograms%\%ProgramFolder%\StartAllBackCfg.exe#$q /activate #$p1"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\sib-reactivate","URL Protocol",""
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\sib-reactivate\shell\open\command","","#$q%PEPrograms%\%ProgramFolder%\StartAllBackCfg.exe#$q /reactivate #$p1"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.AppsFolder\Shell\ChangeIcon","MuiVerb","@shell32.dll,-34608"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.AppsFolder\Shell\ChangeIcon\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.AppsFolder\Shell\Delete","MuiVerb","@shell32.dll,-33553"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.AppsFolder\Shell\Delete","Position","Bottom"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.AppsFolder\Shell\Delete\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication","","Open"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\CopyPath","Extended",""
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\CopyPath","Position","Bottom"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\CopyPath","MuiVerb","@shell32.dll,-30329"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\CopyPath\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Delete","","Uninstall Modern App"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Delete","MuiVerb","@appwiz.cpl,-173"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Delete","Position","Bottom"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Delete","SeparatorBefore",1
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Delete\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\OpenFolder","MuiVerb","@shell32.dll,-32960"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\OpenFolder","Extended",""
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\OpenFolder\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Properties","","Modern App Settings"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Properties","MuiVerb","@shell32.dll,-16534"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Properties","Position","Bottom"
RegWrite,HKLM,REG_DWORD,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Properties","SeparatorBefore",1
RegWrite,HKLM,REG_SZ,"Tmp_Software\Classes\StartIsBack.ImmersiveApplication\Shell\Properties\Command","DelegateExecute","{E5C31EC8-C5E6-4E07-957E-944DB4AAD85E}"

RegWrite,HKLM,REG_SZ,"Tmp_Software\Microsoft\Windows\CurrentVersion\App Paths\StartIsBackCfg.exe","","%PEPrograms%\%ProgramFolder%\StartAllBackCfg.exe"
RegWrite,HKLM,REG_SZ,"Tmp_Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel\NameSpace\{FCEA18FF-BC55-4E63-94D7-1B2EFBFE706F}","","Start menu"

RegHiveUnload,Tmp_Software

[#DownloadProgram#]
// ===============================================================================================================================
// Name...........: DownloadProgram
// Description....: Download the latest setup file.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Modified.......:
// Remarks........: 
// Related........: btn_DownloadProgram, [Process]
// ===============================================================================================================================
[DownloadProgram]
Echo,"Downloading the latest version of %ScriptTitle%..."
WebGet,%DownloadURL%,"%ProgramsCache%\%ProgramFolder%\%SetupExe%",NOERR
If,Not,#r,Equal,200,Halt,"Download failed: The code returned was [#r]."

[#ClearDownloadCache#]
// ===============================================================================================================================
// Name...........: ClearDownloadCache
// Description....: Remove all downloaded setup and program files.
// Syntax.........: Run,%ScriptFile%,ClearDownloadCache
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........: btn_PurgeCache
// ===============================================================================================================================
[ClearDownloadCache]
DirDeleteEx,"%ProgramsCache%\%ProgramFolder%"

[#SetDefaultOptions#]
// ===============================================================================================================================
// Name...........: SetDefaultOptions
// Description....: Sets script options to default values.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........: 
// Related........: btn_SetDefaultOptions
// ===============================================================================================================================
[SetDefaultOptions]
System,Cursor,Wait
WriteInterface,Value,%ScriptFile%,Interface,cb_AlwaysDownload,False

// Start Menu
WriteInterface,Value,%ScriptFile%,Interface,cmb_Theme,"Proper 11"
WriteInterface,Value,%ScriptFile%,Interface,cmb_StartMenuStyle,"Default"
WriteInterface,Value,%ScriptFile%,Interface,cmb_StartMenuIconSize,"M"
WriteInterface,Value,%ScriptFile%,Interface,cmb_Orb,"Default"
WriteInterface,Value,%ScriptFile%,Interface,cb_ShowUserPic,True
WriteInterface,Value,%ScriptFile%,Interface,cb_MakeOpaque,True
WriteInterface,Value,%ScriptFile%,Interface,cb_UseLargeIcons,False
WriteInterface,Value,%ScriptFile%,Interface,cmb_StartMenuLargeAllAppsIcons,"M"
WriteInterface,Value,%ScriptFile%,Interface,cb_SortByName,True
WriteInterface,Value,%ScriptFile%,Interface,cb_SortFoldersFirst,False
WriteInterface,Value,%ScriptFile%,Interface,cb_FlyoutMenu,False
WriteInterface,Value,%ScriptFile%,Interface,cb_ShowSearch,True
WriteInterface,Value,%ScriptFile%,Interface,nb_MaxRecentPgm,10

// Taskbar
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarVisualStyle,"Default"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarIconSize,"M"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarIconMargins,"XS"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarLocation,"Bottom"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarCombineButtons,"Never"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarPlumpness,"None"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarCenterIcons,"No"
WriteInterface,Value,%ScriptFile%,Interface,cmb_TaskbarSegments,"None"
WriteInterface,Value,%ScriptFile%,Interface,cb_TaskbarAutoHide,False
WriteInterface,Value,%ScriptFile%,Interface,cb_TaskbarDynamicTransparency,False
System,Cursor,Normal

[#ToggleAdvancedOptions#]
// ===============================================================================================================================
// Name...........: ToggleAdvancedOptions
// Description....: Show/Hide advanced options.
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........: btn_AdvancedOptions
// ===============================================================================================================================
[ToggleAdvancedOptions]
Message,"There are no advanced options available for this script."

[#ShowScriptInfo#]
// ===============================================================================================================================
// Name...........: ShowScriptInfo
// Description....: 
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........: btn_ScriptInfo
// ===============================================================================================================================
[ShowScriptInfo]
Message,"StartAllBack is a lightweight, full-featured replacement for the Windows Start Menu.#$x#$xStartAllBack comes as a 30-day free trial. If you enjoy StartAllBack please support the developer and purchase a license."

[#Interface#]
// ===============================================================================================================================
// Name...........: Interface
// Description....: 
// Syntax.........: 
// Parameters.....: 
// Return values..: 
// Author.........: Homes32
// Remarks........:
// Related........:
// ===============================================================================================================================
[Interface]
bvl_Homepage=bvl_Homepage,1,12,367,5,72,25
web_Homepage=Homepage,1,10,377,9,60,18,https://www.startallback.com/
btn_DownloadProgram=,1,8,448,5,25,25,DownloadProgram,VistalcoDownload_16.png,False,"__Download the program."
btn_PurgeCache=,1,8,479,5,25,25,ClearDownloadCache,Trash.ico,True,"__Remove all downloaded setup files."
btn_SetDefaultOptions=,1,8,543,5,25,25,SetDefaultOptions,SetDefaults_16.png,True,"__Restore Defaults"
btn_AdvancedOptions=,1,8,574,5,25,25,ToggleAdvancedOptions,Advanced_Disabled_16.png,True,"__Show Advanced Options"
btn_ScriptInfo=,1,8,605,5,25,25,ShowScriptInfo,Help_16.png,True,"__Script Info"
bvl_MenuOptions="Start Menu Options",1,12,5,85,275,319,8,Bold
lbl_VisualOptions="Visual Style",1,1,11,103,70,18,8,Bold
lbl_Theme=Theme:,1,1,16,126,78,18,8,Normal
cmb_Theme="Proper 11",1,4,102,120,150,21,"Proper 11","Kinda 10","Remastered 7"
lbl_Style="Visual style:",1,1,16,153,78,18,8,Normal
cmb_StartMenuStyle=Default,1,4,102,147,150,21,Default,Plain8,"Windows 7"
lbl_StartMenuIconSize="Icon size:",1,1,16,179,67,16,8,Normal
cmb_StartMenuIconSize=M,1,4,102,174,150,21,S,M,L
lbl_Orb="Start button orb:",1,1,16,206,86,18,8,Normal
cmb_Orb=Default,1,4,102,201,150,21,Default,Clover,"Win 8","Win 7",E1even
cb_ShowUserPic="Show user account picture",1,3,15,227,180,16,True
cb_MakeOpaque="Disable transparency",1,3,15,245,180,16,True
lbl_Menu="All Programs Menu",1,1,11,268,108,18,8,Bold
cb_UseLargeIcons="Use large icons",1,3,15,284,180,16,False
cmb_StartMenuLargeAllAppsIcons=M,1,4,115,282,46,21,M,L
cb_SortByName="Sort items by name",1,3,15,302,180,16,True
cb_SortFoldersFirst="Display folders before items",1,3,15,320,180,16,False
cb_FlyoutMenu="Fly-out menu (Windows XP style)",1,3,15,338,233,16,False
cb_ShowSearch="Show the Search Box",1,3,15,356,233,16,True
lbl_RecentItems="Number of recent programs to display:",1,1,16,382,187,18,8,Normal
nb_MaxRecentPgm=,1,2,206,376,40,22,10,1,20,1
lbl_SupportStartIsBack="If you enjoy StartAllBack please support the developer and purchase a license.",1,1,5,435,522,16,8,Normal
cb_AlwaysDownload="Always download latest version",1,3,5,50,177,18,False,"__Enable this option to ensure you always included the latest version of StartIsBack in your build."
bvl_TaskbarOptions="Taskbar Options",1,12,290,85,312,319,8,Bold
lbl_TaskbarVisualStyle="Visual style:",1,1,300,125,68,16,8,Normal
cmb_TaskbarVisualStyle=Default,1,4,390,120,150,21,Default,Plain8,"Windows 7"
lbl_TaskbarIconSize="Icon size:",1,1,300,152,48,16,8,Normal
cmb_TaskbarIconSize=M,1,4,360,147,50,21,S,M,L,XL
lbl_TaskbarIconMargins="Icon margins:",1,1,423,152,66,16,8,Normal
cmb_TaskbarIconMargins=XS,1,4,490,147,50,21,XS,S,M,L,XL
lbl_TaskbarLocation="Taskbar location:",1,1,300,179,81,16,8,Normal
cmb_TaskbarLocation=Bottom,1,4,390,174,150,21,Left,Top,Right,Bottom
lbl_TaskbarCombineButtons="Combine buttons:",1,1,300,206,89,16,8,Normal
cmb_TaskbarCombineButtons=Never,1,4,390,201,150,21,"Always#$c hide labels","When taskbar is full",Never,"Never#$c hide labels","Never group"
lbl_TaskbarPlumpness=Plumpness:,1,1,300,233,86,16,8,Normal
cmb_TaskbarPlumpness=None,1,4,390,228,150,21,None,Buffer,Aura
lbl_TaskbarCenterIcons="Center Icons:",1,1,300,260,86,16,8,Normal
cmb_TaskbarCenterIcons=No,1,4,390,255,199,21,No,"Separately from start button","Together with Start button"
lbl_TaskbarSegments=Segments:,1,1,300,287,86,16,8,Normal
cmb_TaskbarSegments=None,1,4,390,282,199,21,None,"Up to three segments","Just central segment"
cb_TaskbarAutoHide="Auto hide taskbar",1,3,300,315,200,18,False
cb_TaskbarDynamicTransparency="Dynamic transparency/aura/shyness",1,3,300,333,200,18,False

[AuthorEncoded]
StartAllBack_80.png=2093,2896
Logo=StartAllBack_80.png

[EncodedFile-InterfaceEncoded-VistalcoDownload_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADZklEQVQ4jUWT3WubdRTHP89L3p8mTfpim7ZL37ZZp6UTV1F0g00dXky9myAiXhf8A0QRvFCGF96o4IViJ0Mm4lSUIbIqdVs6W+3W1da+LW3SpC9Jm6TJ8+RJ+uT5SdLBDpzD4cD3e76Hc470zIUTHJiMU4szP3Yav+stXr00PVQqNL4SG1ea/ltYW29wp8Y2/roxuTF2CzOhANU6StVLe/VEkqBg5sHv8vf2D38b+Hv4bJdS5chRgcdUuZ28hud4elr+ff1lSCbud0UtapkaHCFnMLNPhc8+/8XsyEsEIxK4VYVCBXo98PP8Ga7eOnbc8l2/pzg/HHD1xJaNhSxq/+N9gI1pO/CrI9+c7yM46AMnIGqDqTCgQjoCi3EX0ptBVaRPfR/76Z/BuoL9vIGo6pjejhcOO7wnxVacsd0k4YYAgz2P4LEhU3PHCk88d4Ngbpu07H4sfT1y3mTtspqYy2OXDfTW1tOPhsfJKVPMbW7QUI4Q7nqPlKgwkbvJkrFNceMQvt4Z8EPjcNuZTHTtslpKeqESIG/FO2NCojtwglTvDI41ia/iP5DyXqNs5PFrTSwsj5CdPYe76Qr5lcZwfYT8TQ+KpWNFAtmELfGj8TUxLUdDeYaN6hKhUBiqMgV1hsaBL1m68ixWIUOlulhfn6IdbaVcbqN8+x2s0OJrpcN3kHRw52t1F3ljmb29KusJnYr0L67QFLolMKaXPy8nzEm19ekZ2WpWPFu/Vv5wO1djzYfoqcjgmHuIwuIHbGkfoYWmEXYDOztFKGqUk3rJuJO9VFdguhGyJd7vPJe46n+4YPs68HqCkDO20AJRukIa89FtbKuCpNrsb/vIfLf1hlXMT9UJnL1QXCLqj8ivt58S7e2tENLADkK3v8zUxR2yq1k8ARV5p43cpPPdStb3mRLqROgpVFcASXFhbE+IC76I8qnvySpeDY41aUx+coS9TRdDJ1swkyqbt/QdW6/OSk1VkOSDUxZVhOIkZGaFvjshVoVX7u4fcpP8s2Iu3M381tf34oqc6rJ25+Y3S/vpFcknTUv79sHz1Ajq0WbX6WfU3LOFdU8dLewL7o5XPqYl/vZc9Beqqx0QEjg0LzIC6T74AYF0QFjc5KJtWslk1Oos5Rn1toDd7MDINSK7aydvI+QHYID/Ab48jqdfCQxIAAAAAElFTkSuQmCCeJwTD8ssLknMSc53yS/Py8lPTIk3NNMryEtnGAUjAsxnxi+fwnL8OSMDAKdDC4fwuePJAQAAAAIAAAAvAAAAnwMAAAAAAAABAAAAAAAAAAAAAAA

[InterfaceEncoded]
VistalcoDownload_16.png=927,1348
Trash.ico=1150,1212
SetDefaults_16.png=2475,3404
Help_16.png=2830,3868
Advanced_Disabled_16.png=474,744

[EncodedFile-InterfaceEncoded-Trash.ico]
lines=0
0=eJx10/1PEnEcB/DzYT2s7GHNHpYrY2221dbjVlsPs9asNVdtPfsHNEtt+ZRsyXjyNAFBHgQjKQi0YEIiBmJmoM5MwTISrOzB0jSndRToYctPd7Yro/re3vfD9+51973P53sIEkEcixYhxDkeSY1GkKUIgqwjQkwRMz/nyZEYjfw1Dh08MGff3sSYlDOndyQkJAiIyIko/hM5jUbjxsWtXL5t65b5R48cnkU+o1wiijx54jjb5eoEj8cDvT4f4DgOg4ODYLXWQUWFEszmGnj6tBtkMhnQ4uOXZV9Ii5i5DpTFyFKpVFMajQa0Wi1YLBYwGAwgkYgBRQugtFQEarUaOGxWIHHXzsXh36EuZpx67+vGxj68w0IT41goFMI+j41ifZ4n/h5XO9bV0jQdvbT4MW31qiXh3iTnn6d8T2NtsFHKDnVZTcG7gsu4hUfHOx/Yp71NI38VHRm5NNzfEjDyST/U1+u3C/NDtuKcSVetPlgvZOBmNCvUqCkPkP7+7RsDC+bNXRPuDWKuiPQ9TdavzUoejo2M+Mn1v3rWjTVXKoPmwks46R2mqqHYhTEbw3217IqG9B57TcBemP6NWMcX0r/xPcNqWecnbSLmBOlb64wfaSti91wVFP5R/3taeR3ph1+/wF4+dAbc+oqJkcEBrNOkCzq15cF2W42f9O0NltENa+KS5byCP7zluqSNqt/rR86Ag5/5zV1TOd6Apk/aRQycqr/L0fBpx/q1KWU8NJKyrfW1Ea13tL2Ux8cD2AuHNeg26cbbNJKJ7pYmP+XdzfexpO2bzmWnpUZRXlcmnNNpqx74V//7+55jM/tP5tj+3fnJB5NmU76Qw0rj83lTErEYhCUloFQqp/egQqEADocDubk5QKfToaioCMTEPedSU8cOHUiaR3leEcro6HgEPq8XHne5YXh4CIj3Q39/P9TX20ClugY6nRaczU7wenuIf0D6PetC+q+/UaVUbMjIyLgnlUqnyH1ebdCDvqoSblXqpve+Ql4GIqEQTEYjCPh8yM3JloX3nxzE2jfT8/K4N9XqD1U6nYfPK85mMpk3Mi9ezEMLCoxcDvssyuXGhzsW0UlH1D8S8Tus8BDX3xIV/AEUry6xeJzjDClKLM7Qy0zOZxgFIxDUsUBoV2bs8iFCkXoMbAB8oQUybAHR5gEAAAACAAAAJAAAAEUDAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-SetDefaults_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHEGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTEwLTIxVDE3OjIxOjEyLTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMWM3ZDhlNS1mMGMxLTMwNDgtOGNiOS03YWU4YjgyNDgyNmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDowNzhkNDM1MC04NWRmLTg4NDQtOTY0Mi1lYTIxNmU3YjUwNDIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMDM1MDg3Mi1hYmUxLWU5NDAtOTE2NC1kYzRjMzdjOGIwOTUiPiA8ZGM6Y3JlYXRvcj4gPHJkZjpTZXE+IDxyZGY6bGk+SG9tZXMzMjwvcmRmOmxpPiA8L3JkZjpTZXE+IDwvZGM6Y3JlYXRvcj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmMDM1MDg3Mi1hYmUxLWU5NDAtOTE2NC1kYzRjMzdjOGIwOTUiIHN0RXZ0OndoZW49IjIwMTktMTAtMjFUMTc6MjE6MTItMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDdmNDNiMDctMTg1NC1hNjQwLWEwM2UtYTQxMTM2YTA0ODA2IiBzdEV2dDp3aGVuPSIyMDE5LTEwLTIxVDE3OjIxOjQ3LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmIxYzdkOGU1LWYwYzEtMzA0OC04Y2I5LTdhZThiODI0ODI2ZCIgc3RFdnQ6d2hlbj0iMjAxOS0xMi0wMlQyMTo1MTo1Mi0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlYy9voAAAJBSURBVDiNpdHLThNRHAbwvkCjpalcSyyUEDo09Jw5MxZeggXdQHSpa96ARTclolWpLYtG20IDwdpaoeVOW63G0gvEmEaj3cFKYrxMXLjw88wAbQ3smOQ3OTn/73yZiw6A7jK0G9tjJ0rcPmtnB8zNFbnjU0VtT52VWD1/UcE4KzOFw39K3D6D44NDYRWeOVdQYKoxDue8YxjeH4b1lRXm5S70v+7HSHlkjO83FeSZkcNFnAUnDFsGuOIu7L0v4M7GbXRlusDeMGO9QMyIHikrYSA7ACEnQF2LuyLkrIzuTDd6Q704rB1CvabWp6B/qYeYFT31AmlTqtrX7XAmb2AwLsCyZoFz2wn7th2GqAHxfEI7nM6voW2+DY4dB8QNsVovsKVsCl2myOXyGrpA0LHSAWOsBZOxSeAL8LH0GWJYRGeyE/KqDHFFVOoFQkJQBucFpFNb+JH/gxeJFMx+M4SADW/TZdR2jnAzdAtXo1cgJ2XQ51TVKGBLrGqJXofkl7C5uotvld9YiC/hSSyCr8VfmF6cQcucAUPPhkAX6ZnGK9Aw9UhRCdeCJhAvQblwAPzkk+9ApXgA6z0rLGELWISBRuiZxkckQWLkIIUkGH1G9Ln7UPtUA/4Co75R6O/rIT2VoGaaNH4jmSM6EiAu4ieQgzJava2QZ2RMBCZgvmsGDVLweTOXeqZR8Jic8JFx8ogosl9Gj7cHpmkTqJ8/7iwvmCUqRcuc5i8q0JGHpJ08IG6uyB1rvNrarc18RHeu4DL+AeXUQV071uymAAAAAElFTkSuQmCCeJwTCk4tcUlNSyzNKSmONzTTK8hLZxgFIwes5sQv/03zkSgjAwBGXgl7UO9x9wEAAAACAAAAKgAAAKsJAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-Help_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHAWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0wMi0yMlQxNjo1OTo1MC0wNjowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTktMTItMDJUMjE6NTM6MDQtMDY6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMTItMDJUMjE6NTM6MDQtMDY6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YWQ2OTFmMzItY2FiZC1hZTQzLTlmNjAtMzk5YjQyOTBlMTNiIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6OTBjZmFlNjAtYWJhZS1iNTQ3LWIyODEtOWYxNzg2YzM1NjQ2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MzUwYTZiYzMtZDFiMi03MjRjLTlmZWQtY2RmYTM4YzhjM2FkIj4gPGRjOmNyZWF0b3I+IDxyZGY6U2VxPiA8cmRmOmxpPkhvbWVzMzI8L3JkZjpsaT4gPC9yZGY6U2VxPiA8L2RjOmNyZWF0b3I+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MzUwYTZiYzMtZDFiMi03MjRjLTlmZWQtY2RmYTM4YzhjM2FkIiBzdEV2dDp3aGVuPSIyMDE4LTAyLTIyVDE2OjU5OjUwLTA2OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MmNhNWFiYy05Mzg0LWUwNGYtOGE5NC0yMTk1NjY1NjY1YTUiIHN0RXZ0OndoZW49IjIwMTgtMDItMjJUMTc6MTA6MDUtMDY6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmFkNjkxZjMyLWNhYmQtYWU0My05ZjYwLTM5OWI0MjkwZTEzYiIgc3RFdnQ6d2hlbj0iMjAxOS0xMi0wMlQyMTo1MzowNC0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PozE0ngAAAOzSURBVDgRBcF9TJR1AMDx7/N7nnuOez/kxUJe4q2pWEgoykxLpqkzx6bhlszN/soZ/dE0W9bWZrVZ2WYt/ypn5VrmzDkZZk2INoRyNJEUUDg4TuC4g7vjjrvjHu7uefp8pJljb2KymMlr2g5rq5H0ZQj6V+mzwYOh4qrGbDyadqN1GfOhK7Hp2cV4VQWRE5+SF42QUVUUAEOSkDJZsMvuQEg68/OgfOBPjzvf4xnDpArW1xQe2rxS/XB/Q8kPzlnv6blYXJeEAEB+Z8MGTOllrE0b13V4uXXk3NDuS3/4rYmoTnGeDUk30f1PkNvDmntQz3/5mecKm2o8//6WGByNY7ehmI0Mec9Xlvw6rf51+Mv7K3IzBmff2sgbB2rJdZpJpZa5NzzJR+fv0dMxwqPZqq0XT37cvqbo/JapvpFl+fPtGxhv2PHjkauxuqJMFpdL5qtTO3A7ZMa8fnJtBmUlKissaR75UmgzER66K4qa1ttVqafvttBLi9d868lpTvkXWVloxunI4cLVfg6/e43GQ9c4e3GAWCDECjVJYikBqsTd30e4mSw9aq0tt4ontvx9vZ4lCi0SmayO2ST45dYYfQNR5r0ZkokkTruG50mYwcdRYnGNwHiQjmHdpW3b2iYixZV74sFFTMJAUWQkIZHSdHwTi5w8VsXpo2WMjgU5ezmA1e7G5bCQ67IyN7FApm7TdpFWFIvIGiiKjCwkxn0R7g/O09pSzmfHy+m6M8He40MMzTgoL3ZiiBzUHDsm1YJsMUtCHfmvU813oMiCJ/4Y4WgKcszUP2sFC1zuijA6qlJT5ULHhGq2ogsHT6+uQNztva8UxWba66rrT10fnkMsazhtKkIxOPeTB99kmP5HOgWVuUjChCzMWK0qWtLOltUWTe3u/VoUKNm/D1Yu9U9rglQ8jWwSxGMp9r5Uxqu7XqTt8CYcFkEqo+ByWPEFFNbWV/Oa5cHV2FR4WgQmw2yd6Gl7v7WIuTmZQDBJPLFMy+5KtjWWcGRfAZKRQVWt+OYkYvYyPtm1EOHCF+8FH3iR366vRQuEppsb3SPyuqr9XQNLUjaR5nr3FOGFBT74ZoBRv5m47iSvZBXfn3DP1E5d2TP43Y3Hsm4gH9/8AlmbHWMp9XBnafbOtj01lSa7rdQbynDrxgQR3DQ0VvB6UwFndgban5q82eqZiD6QRscR2SwKgGToaLKKP5Tu3Gib7Fxd4Ws5+Upd82JuwypTNqMXJANeOTxwCd9i91g4jaSawTAA+B9saZuyCHkkigAAAABJRU5ErkJggnic4/ZIzSmINzTTK8hLZxgFIw7wceOXd9V7kMTIAAAhOQWdbDOZ9gEAAAACAAAAIwAAAA4LAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-AuthorEncoded-StartAllBack_80.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAH30lEQVR42u2da2xUWR3Af2cedzrTKdPXlE6tJW0t2IKxroClFaZAYPGDCR/WoAk+PxizbmgNCQE1RN0l6xdTIYFk/eBmTTChiqkramA3pMJCBMJWU/og7M4q2Ba3hWnLMO287vXDdOrM9HVn5vY595806Zxzz5z7//V//ud/nhWkKIWFhdTU1FBeXo7BYGA5RVEUhBCafNfIyAgej4dHjx4hy7LqcqprN5vNbN++nbKyMlaKaAkwJj6fj1u3bvH06VPtAJpMJnbt2kVRUVFylgPYCTQAnwSkVQIwCDwC/g5cB8biM0OhENeuXVMFUaixvJ07dybDswMtwMuAKxVL1higIjIzQQUYAs4BpwHfNOFgkOvXry8IccHKa2pqqK+vT0gCLgD1ywVOQ4DxIP8BHAIexBKHh4fp7Oycv3UuZH21tbXxSdXAu0AFa0sE8Lkp3fYAHwI4nU5cLhdDQ0PpAayoqMBiscQ+5gC/WYPwElSe0nEvMBlrgWkDtNvt8R+/CTTO6EUcDvbs2UNdXR25ubmaaXL27FkGBgamP0uSxNGjR8nLy8u4E3n+/Dm9vb1cvXqVsbGx5OzGKV3fALDZbAghUBQldYAlJSXxJn40Ob+yspLW1laKi4s1NwVJSuzQhRCUl5eTn5+vSRhTV1dHc3Mzp0+fxuPxJGcfBX4FKHl5eVitVvx+f+oA4+QzU51HgoItLS2LAm+ppLi4mCNHjnDs2DGCwWByR1kH9CwY4qms64UZdt7YiNPpXPVOz+l00tjYOFtvu01LgOuTE6qqqtZMz1FVVTUbwPWqBhnpVmo2m9cMwEx0MaFLRqID1AHqADOS4eFhPB4PoVBowWfz8vLYtGkTOTk5OkCArq4uzp07x8TEhPqxWkUFJ06cYN26ddkNUJZlOjo6UoIH8PDhQ27evMmBAweyG6CiKMmjB9Uy17AsqwAajUaam5s5f/58SmsYdrudpqYmHSDA/v37KS0tpa+vj3A4vODzubm5NDU1sX79eh0gRGdo6uvrk2fM9TBGjwN1gLpkBcDJyUkuXbrE/fv3VT1vNpvZvXs327Zt02xBflUDbG9v58qVKymV6e3t5fjx48mrjdkHMBwO093dnVa5e/fu6QCNRiMlJSXzLjnOJXocOBUDHj58GK/XqxqiEIKGhgZ27NihAwRwuVycOnUKr9erajgnSRIOh2Npe+G4BWVlnrxFmzBYKE0IoRQWFmb0nZnoYlJj9rFf4ypTVlBTFlq5BD2Q1gPp1MXv9zM4OKjqWYvFgsvlwmQy6QABHjx4wJkzZ/B6varLbN68mdbWVmw2mw6wvb09JXgAPT093Lhxg3379mU3wEgkwvj4eFplZ9nSlp0jkYaGBi5evJhSOYvFwtatW3WAAAcPHqSoqIj+/n5VcZwkSbjdbjZs2KADjMVubrcbt9uthzF6HKgD1CXrAIbDYTo7O+nt7SUSiSz4vNVqxe12U1tbq0/pA3R0dNDR0ZFSmdu3b3Py5EkqKyuzG6Asy9y5cyflcsFgkLt37+oADQYDDocj4TCOWikoKNB9IMChQ4doa2tjdHRUdZktW7bom4tiUl1dTVtbGyMjI+qUNZlwOp2aHtJe9WGMJEnLeopejwN1gCsYoIJARiBQlvdo+jKIMqV/RgB9pnyEuRhb5BmSPJlVAEOGHPzG6NlkWRjTAzguOQlbXBgnH2YdwIDBitdSljnAgMXFUO5GQobEwyme9wvI9wwsmgIfin1MlE0kBM4v/X4Uk8mneV2jowX8x/X1hDSzPElO+FmGAM1OTJYyfOZCgqbYKpYAReHjJ8CT54toA6VgTUx5/O8AEEhM1MQ5S2BLHNpJYT/2UPTKE5k0AfqkIrCUoszzF1izPtBoZdRQmpkFysIEhuyMdBQhUMSU7vOMXNKmYzIKjIa1EdxEZIWwvEibi+aSn+0t5mCdfU0A7Oj18cN3hpcWYIndSHXh8h/712JioMSevo/Xh3IrbSzcNxzk/cEAsgZbCI1C0FCRQ1WBOTsAXuh+xnf+8JhwRLv9lzbJwIWvlrH/U7bVClDM6XiS/c9Prz4hLM/f7acq/pDCL957yos1M+/l0nan7JLuUJ39vQNhZc68jIJamexowq/syOf45WFNX9AoBN/d6lj1AGeY1Xhgpln8oLGAz5ZauDsY0OTlDMCuSivby62LCmE2XdQ2JbUA/5Wc8Hafj+9/IT/BDwoh2Fudy97qXFaLKIrC230+VTpnAvA9IAL/n5bo/GiCt7rG+dYLDlazvNU1TudHM27+iBC93TdDgBPT+48Hid4v+mK8hb/yp4/pfhzg25938Il1puWZ9hfpWB0MjId58+4Yb9yZdbvvu0Rv94WgH8KBNKv/4svRn6g0Ap2AOdk9mA0CySiW405fJS2ECgQjyly9ewhoBm4C8N9+ePOlNC3w/jvQ9L3YO94EXgV+kvzSoYhCKLJsh5cUjb/r1Wl4AP2XM2jCww/gg2tQM72F9nUQDhSlJd4fLu9sgmZ2HyZ6Gffr0ym+J9D9xww9iKMMvvFbyI3dZC4MKMpXgNeI3iu9FgB+APwY+B0QbdiyDH/+EfRc0sAFO2vga78GWz6xNRGi18F/aern08xYwVi5nUisiwTuA38B/krcNfAAXH4Nui5oWL1zI3z551Cyca6Yd+n/N4aiZDLulqetLWHw7YW//RL+qe78yf8AvO98RIyww5cAAAAASUVORK5CYIJ4nBMOLkksKnHMyXFKTM6OtzDQK8hLZxgFIwbocuCXF31s48bIAACfdAiWoeK2bgEAAAACAAAAKwAAAC0IAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-Advanced_Disabled_16.png]
lines=0
0=iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQ4y43Tz4tNcRgG8M+dOTGuRLhF9hi/h81IKRuR1IhSxIIssPAn3J1mb2oSNso0O2oWiIwNu2FWw21YkEm6ykwmv5XNc+rQnfLW6Zy+z/d9zvO+z/vWms2mBeIcjuMrhnC/06Wi8r0Ku/EIX9DACixHbwgW4wieo1UlWIsLOIWbmEA/fuI3NmMv9uEknmAQrZKgL8mvcAjH8A2LgveHYB5vQvSgSvAUI9iPOdQwhcngO7Ap2MqoHKuWMIu7+XMX7uAGZoKvw1kMoAfP8LkkOJAaN+I7XmAY7UqDZ3K2IUrOpLEfC1zEGvyI9Ml/kstoB9seh47iU4F6Erv8X9TiTjdqBUaxOjPQk4Y1OqhoBPuFt5mF+QLXcmEAl1Pb+QWa2BsFj3G96sIy7MzYzoVsfQcbZ7EUu3AP70qCwziN6fhcx7YkSs319KmNgyG/WhJMYBx7cCujeiIquvEeV+LApezLw2oJrcx2H25nHrZiC5akaeN5XuNl3n9tY6vcsMQUPqTm6cr5WNWaPzh+YcvU7DU1AAAAAElFTkSuQmCCeJyTcEwpS8xLTk2Jd8ksTkzKATIMzfQK8tIZRsFIALcY8ct/c/M8xcgAANAVDAqUbKQXAQAAAAIAAAAvAAAA2gEAAAAAAAABAAAAAAAAAAAAAAA
